# =========================================
# ENVIRONMENT CONFIGURATION
# =========================================
NODE_ENV=development
PORT=3000
LOG_LEVEL=info

# =========================================
# DATABASE CONFIGURATION
# =========================================
# PostgreSQL Database URL
# Format: postgresql://username:password@host:port/database
# For Docker: postgresql://lms_user:123456@postgres:5432/lms_db
# For Local: postgresql://lms_user:123456@localhost:5432/lms_db
DATABASE_URL=postgresql://postgres.bavyiitubxjhaoknuuvj:<password>@aws-1-ap-southeast-1.pooler.supabase.com:5432/postgres

# =========================================
# REDIS CONFIGURATION
# =========================================
# Redis URL for caching and session storage
# For Docker: redis://redis:6379
# For Local: redis://localhost:6379
REDIS_URL=redis://localhost:6379

# =========================================
# JWT CONFIGURATION
# =========================================
# JWT Secret Key (CHANGE IN PRODUCTION!)
JWT_SECRET=your_jwt_secret_key
JWT_EXPIRES_IN=24h
JWT_REFRESH_EXPIRES_IN=7d
JWT_ISSUER=lms-backend
JWT_AUDIENCE=lms-frontend

# =========================================
# FRONTEND CONFIGURATION
# =========================================
# Frontend URL for CORS and redirects
FRONTEND_URL=http://localhost:5174

# Centralized CORS configuration (used by config/cors.config.ts)
# Multiple origins separated by comma
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5174,http://localhost:3001,http://localhost:8080,http://192.168.1.136:5174
# Allowed methods
CORS_ALLOWED_METHODS=GET,POST,PUT,PATCH,DELETE,OPTIONS
# Allowed headers
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With
# Whether to send credentials (cookies/authorization headers)
CORS_ALLOW_CREDENTIALS=true

# =========================================
# FILE UPLOAD CONFIGURATION
# =========================================
# Maximum file size in bytes (10MB)
MAX_FILE_SIZE=10485760
# Upload directory path
UPLOAD_PATH=./uploads

# =========================================
# EMAIL CONFIGURATION
# =========================================
# SMTP Configuration for sending emails

# =========================================
# EXTERNAL SERVICES CONFIGURATION
# =========================================
# Cloud Storage Configuration (future)

# =========================================
# RATE LIMITING CONFIGURATION
# =========================================
# Rate limiting settings
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# =========================================
# CACHE CONFIGURATION
# =========================================
# Cache TTL settings (in seconds)
CACHE_TTL_SHORT=300
CACHE_TTL_MEDIUM=1800
CACHE_TTL_LONG=3600

# =========================================
# SECURITY CONFIGURATION
# =========================================
# Password security settings
BCRYPT_ROUNDS=12
PASSWORD_MIN_LENGTH=8
PASSWORD_MAX_LENGTH=128

# Session settings
SESSION_SECRET=your-session-secret-key-change-in-production
SESSION_MAX_AGE=86400000

# =========================================
# MONITORING CONFIGURATION
# =========================================
# Health check settings
HEALTH_CHECK_TIMEOUT=5000
HEALTH_CHECK_INTERVAL=30000

# Metrics settings
METRICS_ENABLED=true
METRICS_PORT=9090

# OpenTelemetry Configuration
# Set to true only in production or when you have OTLP collector running
ENABLE_OTLP=false
OTEL_EXPORTER_OTLP_TRACES_ENDPOINT=http://localhost:4318/v1/traces

# =========================================
# API VERSIONING CONFIGURATION
# =========================================
# Default API version
DEFAULT_API_VERSION=v1.3.0
# Supported API versions (comma-separated)
SUPPORTED_API_VERSIONS=v1.0.0,v1.1.0,v1.2.0,v2.0.0

# =========================================
# DEVELOPMENT CONFIGURATION
# =========================================
# Development-specific settings
DEBUG=false
VERBOSE_LOGGING=false
HOT_RELOAD=true

# =========================================
# PRODUCTION CONFIGURATION
# =========================================
# Production-specific settings (uncomment for production)
# NODE_ENV=production
# LOG_LEVEL=warn
# DEBUG=false
# VERBOSE_LOGGING=false
# HOT_RELOAD=false

# =========================================
# EMAIL CONFIGURATION
# =========================================
# SMTP Configuration for sending emails
MAIL_HOST=smtp.gmail.com
MAIL_PORT=587
MAIL_SECURE=false
MAIL_USER=***
MAIL_PASS=***
MAIL_FROM=LMS System <noreply@lms.com>

# Alternative email configuration names
EMAIL_HOST=
EMAIL_PORT=587
EMAIL_USER=
EMAIL_PASS=
EMAIL_FROM=

# =========================================
# EXTERNAL SERVICES CONFIGURATION
# =========================================
# Storage Configuration (Cloudflare R2)
STORAGE_TYPE=r2

# Tên Bucket bạn đã tạo ở Phần 2
R2_BUCKET_NAME=lms-video-storage

# Thông tin xác thực lấy ở Phần 3
R2_ACCESS_KEY_ID=***
R2_SECRET_ACCESS_KEY=***

# Endpoint dùng để upload (Lấy ở Phần 3)
# Định dạng thường là: https://<ACCOUNT_ID>.r2.cloudflarestorage.com
R2_ENDPOINT=https://***.r2.cloudflarestorage.com

# URL công khai để sinh viên xem video (Lấy ở Phần 2 - Public Access)
# Định dạng: https://pub-xxxxxxxx.r2.dev
R2_PUBLIC_URL=https://pub-***.r2.dev

# CLOUDINARY CONFIGURATION (Dùng cho ảnh: Avatar, Thumbnail)
CLOUDINARY_CLOUD_NAME=***
CLOUDINARY_API_KEY=***
CLOUDINARY_API_SECRET=***

# =========================================
# GOOGLE DRIVE OAUTH 2.0 CONFIG
GOOGLE_CLIENT_ID=***.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=***-***
GOOGLE_REFRESH_TOKEN=1//***Pj1zYhxesOjKrieIIaNyDe3QXEc0
GOOGLE_REDIRECT_URI=https://developers.google.com/oauthplayground

# ID thư mục LMS_DATA/DB_Backups (Vẫn giữ nguyên cái cũ)
GOOGLE_DRIVE_FOLDER_ID=https://drive.google.com/drive/folders/***

# ID thư mục gốc chứa tài liệu khóa học (Course Resources)
# Ví dụ: LMS_DATA/Course_Resources
GDRIVE_RESOURCES_FOLDER_ID=https://drive.google.com/drive/folders/***

# ID thư mục gốc chứa raw livestream recordings
GDRIVE_LIVE_RAW_FOLDER_ID=https://drive.google.com/drive/folders/***

# ID thư mục gốc chứa backup database
GDRIVE_BACKUP_FOLDER_ID=https://drive.google.com/drive/folders/***

# Twilio Network Traversal Service
TWILIO_NTS_ENABLED=true
TWILIO_ACCOUNT_SID=***
TWILIO_AUTH_TOKEN=***

# Gemini API Key / AI Services
GEMINI_API_KEY=***
GEMINI_MODEL=gemini-2.5-flash
GEMINI_TEMPERATURE=0.7
GEMINI_MAX_TOKENS=8192

# Pinata IPFS Configuration
PINATA_API_KEY=***
PINATA_SECRET_KEY=***
PINATA_GATEWAY_URL=https://gateway.pinata.cloud/ipfs/

# GROQ API KEY / AI Services
GROQ_API_KEY=gsk_***

# BLockchain KEY
BLOCKCHAIN_NETWORK=sepolia
PRIVATE_KEY=***
SEPOLIA_RPC_URL=https://eth-sepolia.g.alchemy.com/v2/Hs-***

CERTIFICATE_CONTRACT_ADDRESS=***  # Sẽ có sau khi deploy

FORCE_DELETE_LIVESTREAMS=true

# Gemini API Keys (Multiple keys for rotation - 20 RPD per key per model)
# Add more Google AI Studio API keys to increase total capacity
GEMINI_API_KEY=***
GEMINI_API_KEY_2=***      # Optional: Add 2nd Google account API key
GEMINI_API_KEY_3=***     # Optional: Add 3rd Google account API key
GEMINI_TEMPERATURE=0.7
GEMINI_MAX_TOKENS=8192

# Google AI Models (Task-specific routing + multi-key rotation)
# With 3 API keys: 3 keys × 5 models × 20 RPD = 300 RPD total capacity
GOOGLE_MODEL_3_FLASH=gemini-3-flash-preview                          # Best for code/complex
GOOGLE_MODEL_2_5_FLASH=gemini-2.5-flash                      # General purpose
GOOGLE_MODEL_2_5_FLASH_TTS=gemini-2.5-flash-preview-tts             # Multi-modal (audio/image)
GOOGLE_MODEL_2_5_FLASH_LITE=gemini-2.5-flash-lite          # Complex reasoning

GROQ_API_KEY=gsk_***

# Model mặc định cho general tasks
GROQ_MODEL_DEFAULT=llama-3.3-70b-versatile

# Models cho specific tasks (optional, sẽ fallback về default nếu không set)
GROQ_MODEL_REASONING=llama-3.3-70b-versatile
GROQ_MODEL_MATH=qwen/qwen3-32b
GROQ_MODEL_VISION=meta-llama/llama-4-scout-17b-16e-instruct
GROQ_MODEL_SPEECH=whisper-large-v3-turbo
# General settings
GROQ_TEMPERATURE=0.7
GROQ_MAX_TOKENS=2048

# --------------------------------------------
# TIER 2: Powerful + Local (ProxyPal)
# --------------------------------------------

# ProxyPal - Local AI Gateway
# Cần chạy ProxyPal trên máy local trước khi enable
# Models available qua ProxyPal:
#   - gemini-3-pro-preview (1M context) - Cho content repurposing, quiz generation
#   - qwen3-coder-plus (32K context) - Cho code grading, technical review
#   - qwen3-coder-flash (128K context) - Cho code generation, fast review
# Lưu ý: Từ trong Docker container, cần dùng:
#   - host.docker.internal:8317 (Windows/Mac Docker Desktop)
#   - 172.17.0.1:8317 (Linux Docker)  
#   - <YOUR_HOST_IP>:8317 (nếu các cách trên không work)
# Tạm thời disable để test Groq + Google AI trước
PROXYPAL_BASE_URL=http://host.docker.internal:8317/v1
PROXYPAL_API_KEY=proxypal-local
PROXYPAL_ENABLED=true
PROXYPAL_TIMEOUT=60000

# --------------------------------------------
# TIER 3: Premium (Optional)
# --------------------------------------------

# MegaLLM - Premium AI Provider
# Chỉ dùng cho critical operations:
#   - Grade appeals (học viên kháng nghị điểm)
#   - Final exam generation
#   - Multi-agent debate arbitration
# Models: Claude Sonnet 4.5 ($3/$15 per M tokens), Claude Opus 4.5 ($5/$25 per M tokens)
# Budget: $150 total credit
MEGALM_API_KEY=sk-mega-***
MEGALM_API_KEY_2=sk-mega-***
MEGALM_BASE_URL=https://megallm.io/
# --------------------------------------------
# AI Features Toggles
# --------------------------------------------
# Bật/tắt các tính năng AI (true/false)
AI_TUTOR_ENABLED=true
AI_QUIZ_GENERATOR_ENABLED=true
AI_GRADER_ENABLED=false
AI_CONTENT_REPURPOSING_ENABLED=false