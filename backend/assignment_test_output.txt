
> backend@1.0.0 test:integration
> cross-env TEST_CATEGORY=integration jest --testPathPatterns=integration --runInBand --detectOpenHandles src/tests/integration/modules/assignment/assignment.service.integration.test.ts

FAIL src/tests/integration/modules/user/user.admin.controller.test.ts (16.8 s)
  ΓùÅ Console

    console.log
      [dotenv@17.2.3] injecting env (25) from src\tests\integration\test.env -- tip: ≡ƒöÉ prevent committing .env to code: https://dotenvx.com/precommit

      at _log (node_modules/dotenv/lib/main.js:142:11)

    console.log
      [API_ROUTE_DEBUG_COUNT] 4

      at Object.<anonymous> (src/app.ts:150:11)

    console.log
      [API_ROUTE_DEBUG_LIST] [
        'GET /users/profile',
        'PUT /users/profile',
        'PUT /users/change-password',
        'GET /__routes_debug'
      ]

      at Object.<anonymous> (src/app.ts:152:11)

    console.log
      OpenTelemetry tracing started (local only, no OTLP export)

      at log (src/tracing/tracing.ts:45:15)

    console.log
      Γ£à Model associations setup completed

      at log (src/models/associations.ts:263:11)

    console.log
      Γ£à Extended model associations setup completed

      at log (src/models/associations-extended.ts:340:11)

    console.error
      [SQL_SHIM_ERROR] default null value in column "username" of relation "users" violates not-null constraint <<non-string-sql>>

      126 |         .catch((err: any) => {
      127 |         // eslint-disable-next-line no-console
    > 128 |         console.error('[SQL_SHIM_ERROR] default', err?.message, typeof sqlText === 'string' ? sqlText : '<<non-string-sql>>');
          |                 ^
      129 |         throw err;
      130 |       });
      131 |     };

      at src/tests/utils/test.utils.ts:128:17
      at PostgresQueryInterface.insert (node_modules/sequelize/src/dialects/abstract/query-interface.js:795:21)
      at model.save (node_modules/sequelize/src/model.js:4154:35)
      at Function.create (node_modules/sequelize/src/model.js:2305:12)
      at UserRepository.create (src/repositories/base.repository.ts:45:24)
      at GlobalUserService.addUser (src/services/global/user.service.ts:269:20)
      at UserAdminController.createUser (src/modules/user/user.admin.controller.ts:88:20)

    console.log
      2025-11-16 23:33:35 [error]: Error creating User: null value in column "username" of relation "users" violates not-null constraint {
        "service": "lms-backend",
        "name": "SequelizeDatabaseError",
        "parent": {
          "length": 620,
          "name": "error",
          "severity": "ERROR",
          "code": "23502",
          "detail": "Failing row contains (fe1d6d81-6186-4005-9603-f112f04f7c8d, testuser-1763310814755@example.com, null, $2b$12$4zDs9XNdl/BG5FltNqyC5eA79woe/dqX7bIEODCfBHL7D9DmQLkJ6, Test, User, null, null, null, student, pending, f, null, null, null, null, null, f, null, null, null, 0, null, 1, null, null, {}, {}, null, null, null, null, null, 2025-11-16 16:33:35.088+00, 2025-11-16 16:33:35.088+00, null, null, null, null, null, null, null, null, null, null, null).",
          "schema": "public",
          "table": "users",
          "column": "username",
          "file": "execMain.c",
          "line": "1971",
          "routine": "ExecConstraints",
          "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
          "parameters": [
            "fe1d6d81-6186-4005-9603-f112f04f7c8d",
            "testuser-1763310814755@example.com",
            "$2b$12$4zDs9XNdl/BG5FltNqyC5eA79woe/dqX7bIEODCfBHL7D9DmQLkJ6",
            false,
            "Test",
            "User",
            "student",
            "pending",
            1,
            "{}",
            "{}",
            "2025-11-16 16:33:35.088 +00:00",
            "2025-11-16 16:33:35.088 +00:00"
          ]
        },
        "original": {
          "length": 620,
          "name": "error",
          "severity": "ERROR",
          "code": "23502",
          "detail": "Failing row contains (fe1d6d81-6186-4005-9603-f112f04f7c8d, testuser-1763310814755@example.com, null, $2b$12$4zDs9XNdl/BG5FltNqyC5eA79woe/dqX7bIEODCfBHL7D9DmQLkJ6, Test, User, null, null, null, student, pending, f, null, null, null, null, null, f, null, null, null, 0, null, 1, null, null, {}, {}, null, null, null, null, null, 2025-11-16 16:33:35.088+00, 2025-11-16 16:33:35.088+00, null, null, null, null, null, null, null, null, null, null, null).",
          "schema": "public",
          "table": "users",
          "column": "username",
          "file": "execMain.c",
          "line": "1971",
          "routine": "ExecConstraints",
          "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
          "parameters": [
            "fe1d6d81-6186-4005-9603-f112f04f7c8d",
            "testuser-1763310814755@example.com",
            "$2b$12$4zDs9XNdl/BG5FltNqyC5eA79woe/dqX7bIEODCfBHL7D9DmQLkJ6",
            false,
            "Test",
            "User",
            "student",
            "pending",
            1,
            "{}",
            "{}",
            "2025-11-16 16:33:35.088 +00:00",
            "2025-11-16 16:33:35.088 +00:00"
          ]
        },
        "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
        "parameters": [
          "fe1d6d81-6186-4005-9603-f112f04f7c8d",
          "testuser-1763310814755@example.com",
          "$2b$12$4zDs9XNdl/BG5FltNqyC5eA79woe/dqX7bIEODCfBHL7D9DmQLkJ6",
          false,
          "Test",
          "User",
          "student",
          "pending",
          1,
          "{}",
          "{}",
          "2025-11-16 16:33:35.088 +00:00",
          "2025-11-16 16:33:35.088 +00:00"
        ],
        "stack": "Error: \n    at Query.run (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\postgres\\query.js:76:25)\n    at H:\\DACN\\backend\\node_modules\\sequelize\\src\\sequelize.js:650:28\n    at PostgresQueryInterface.insert (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\abstract\\query-interface.js:795:21)\n    at model.save (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:4154:35)\n    at Function.create (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:2305:12)\n    at UserRepository.create (H:\\DACN\\backend\\src\\repositories\\base.repository.ts:45:24)\n    at GlobalUserService.addUser (H:\\DACN\\backend\\src\\services\\global\\user.service.ts:269:20)\n    at UserAdminController.createUser (H:\\DACN\\backend\\src\\modules\\user\\user.admin.controller.ts:88:20)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:33:35 [error]: Error adding user: null value in column "username" of relation "users" violates not-null constraint {
        "service": "lms-backend",
        "name": "SequelizeDatabaseError",
        "parent": {
          "length": 620,
          "name": "error",
          "severity": "ERROR",
          "code": "23502",
          "detail": "Failing row contains (fe1d6d81-6186-4005-9603-f112f04f7c8d, testuser-1763310814755@example.com, null, $2b$12$4zDs9XNdl/BG5FltNqyC5eA79woe/dqX7bIEODCfBHL7D9DmQLkJ6, Test, User, null, null, null, student, pending, f, null, null, null, null, null, f, null, null, null, 0, null, 1, null, null, {}, {}, null, null, null, null, null, 2025-11-16 16:33:35.088+00, 2025-11-16 16:33:35.088+00, null, null, null, null, null, null, null, null, null, null, null).",
          "schema": "public",
          "table": "users",
          "column": "username",
          "file": "execMain.c",
          "line": "1971",
          "routine": "ExecConstraints",
          "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
          "parameters": [
            "fe1d6d81-6186-4005-9603-f112f04f7c8d",
            "testuser-1763310814755@example.com",
            "$2b$12$4zDs9XNdl/BG5FltNqyC5eA79woe/dqX7bIEODCfBHL7D9DmQLkJ6",
            false,
            "Test",
            "User",
            "student",
            "pending",
            1,
            "{}",
            "{}",
            "2025-11-16 16:33:35.088 +00:00",
            "2025-11-16 16:33:35.088 +00:00"
          ]
        },
        "original": {
          "length": 620,
          "name": "error",
          "severity": "ERROR",
          "code": "23502",
          "detail": "Failing row contains (fe1d6d81-6186-4005-9603-f112f04f7c8d, testuser-1763310814755@example.com, null, $2b$12$4zDs9XNdl/BG5FltNqyC5eA79woe/dqX7bIEODCfBHL7D9DmQLkJ6, Test, User, null, null, null, student, pending, f, null, null, null, null, null, f, null, null, null, 0, null, 1, null, null, {}, {}, null, null, null, null, null, 2025-11-16 16:33:35.088+00, 2025-11-16 16:33:35.088+00, null, null, null, null, null, null, null, null, null, null, null).",
          "schema": "public",
          "table": "users",
          "column": "username",
          "file": "execMain.c",
          "line": "1971",
          "routine": "ExecConstraints",
          "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
          "parameters": [
            "fe1d6d81-6186-4005-9603-f112f04f7c8d",
            "testuser-1763310814755@example.com",
            "$2b$12$4zDs9XNdl/BG5FltNqyC5eA79woe/dqX7bIEODCfBHL7D9DmQLkJ6",
            false,
            "Test",
            "User",
            "student",
            "pending",
            1,
            "{}",
            "{}",
            "2025-11-16 16:33:35.088 +00:00",
            "2025-11-16 16:33:35.088 +00:00"
          ]
        },
        "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
        "parameters": [
          "fe1d6d81-6186-4005-9603-f112f04f7c8d",
          "testuser-1763310814755@example.com",
          "$2b$12$4zDs9XNdl/BG5FltNqyC5eA79woe/dqX7bIEODCfBHL7D9DmQLkJ6",
          false,
          "Test",
          "User",
          "student",
          "pending",
          1,
          "{}",
          "{}",
          "2025-11-16 16:33:35.088 +00:00",
          "2025-11-16 16:33:35.088 +00:00"
        ],
        "stack": "Error: \n    at Query.run (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\postgres\\query.js:76:25)\n    at H:\\DACN\\backend\\node_modules\\sequelize\\src\\sequelize.js:650:28\n    at PostgresQueryInterface.insert (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\abstract\\query-interface.js:795:21)\n    at model.save (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:4154:35)\n    at Function.create (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:2305:12)\n    at UserRepository.create (H:\\DACN\\backend\\src\\repositories\\base.repository.ts:45:24)\n    at GlobalUserService.addUser (H:\\DACN\\backend\\src\\services\\global\\user.service.ts:269:20)\n    at UserAdminController.createUser (H:\\DACN\\backend\\src\\modules\\user\\user.admin.controller.ts:88:20)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:33:35 [error]: Error creating user: null value in column "username" of relation "users" violates not-null constraint {
        "service": "lms-backend",
        "name": "SequelizeDatabaseError",
        "parent": {
          "length": 620,
          "name": "error",
          "severity": "ERROR",
          "code": "23502",
          "detail": "Failing row contains (fe1d6d81-6186-4005-9603-f112f04f7c8d, testuser-1763310814755@example.com, null, $2b$12$4zDs9XNdl/BG5FltNqyC5eA79woe/dqX7bIEODCfBHL7D9DmQLkJ6, Test, User, null, null, null, student, pending, f, null, null, null, null, null, f, null, null, null, 0, null, 1, null, null, {}, {}, null, null, null, null, null, 2025-11-16 16:33:35.088+00, 2025-11-16 16:33:35.088+00, null, null, null, null, null, null, null, null, null, null, null).",
          "schema": "public",
          "table": "users",
          "column": "username",
          "file": "execMain.c",
          "line": "1971",
          "routine": "ExecConstraints",
          "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
          "parameters": [
            "fe1d6d81-6186-4005-9603-f112f04f7c8d",
            "testuser-1763310814755@example.com",
            "$2b$12$4zDs9XNdl/BG5FltNqyC5eA79woe/dqX7bIEODCfBHL7D9DmQLkJ6",
            false,
            "Test",
            "User",
            "student",
            "pending",
            1,
            "{}",
            "{}",
            "2025-11-16 16:33:35.088 +00:00",
            "2025-11-16 16:33:35.088 +00:00"
          ]
        },
        "original": {
          "length": 620,
          "name": "error",
          "severity": "ERROR",
          "code": "23502",
          "detail": "Failing row contains (fe1d6d81-6186-4005-9603-f112f04f7c8d, testuser-1763310814755@example.com, null, $2b$12$4zDs9XNdl/BG5FltNqyC5eA79woe/dqX7bIEODCfBHL7D9DmQLkJ6, Test, User, null, null, null, student, pending, f, null, null, null, null, null, f, null, null, null, 0, null, 1, null, null, {}, {}, null, null, null, null, null, 2025-11-16 16:33:35.088+00, 2025-11-16 16:33:35.088+00, null, null, null, null, null, null, null, null, null, null, null).",
          "schema": "public",
          "table": "users",
          "column": "username",
          "file": "execMain.c",
          "line": "1971",
          "routine": "ExecConstraints",
          "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
          "parameters": [
            "fe1d6d81-6186-4005-9603-f112f04f7c8d",
            "testuser-1763310814755@example.com",
            "$2b$12$4zDs9XNdl/BG5FltNqyC5eA79woe/dqX7bIEODCfBHL7D9DmQLkJ6",
            false,
            "Test",
            "User",
            "student",
            "pending",
            1,
            "{}",
            "{}",
            "2025-11-16 16:33:35.088 +00:00",
            "2025-11-16 16:33:35.088 +00:00"
          ]
        },
        "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
        "parameters": [
          "fe1d6d81-6186-4005-9603-f112f04f7c8d",
          "testuser-1763310814755@example.com",
          "$2b$12$4zDs9XNdl/BG5FltNqyC5eA79woe/dqX7bIEODCfBHL7D9DmQLkJ6",
          false,
          "Test",
          "User",
          "student",
          "pending",
          1,
          "{}",
          "{}",
          "2025-11-16 16:33:35.088 +00:00",
          "2025-11-16 16:33:35.088 +00:00"
        ],
        "stack": "Error: \n    at Query.run (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\postgres\\query.js:76:25)\n    at H:\\DACN\\backend\\node_modules\\sequelize\\src\\sequelize.js:650:28\n    at PostgresQueryInterface.insert (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\abstract\\query-interface.js:795:21)\n    at model.save (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:4154:35)\n    at Function.create (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:2305:12)\n    at UserRepository.create (H:\\DACN\\backend\\src\\repositories\\base.repository.ts:45:24)\n    at GlobalUserService.addUser (H:\\DACN\\backend\\src\\services\\global\\user.service.ts:269:20)\n    at UserAdminController.createUser (H:\\DACN\\backend\\src\\modules\\user\\user.admin.controller.ts:88:20)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:33:35 [error]: HTTP error occurred {
        "service": "lms-backend",
        "error": "null value in column \"username\" of relation \"users\" violates not-null constraint",
        "stack": "Error: \n    at Query.run (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\postgres\\query.js:76:25)\n    at H:\\DACN\\backend\\node_modules\\sequelize\\src\\sequelize.js:650:28\n    at PostgresQueryInterface.insert (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\abstract\\query-interface.js:795:21)\n    at model.save (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:4154:35)\n    at Function.create (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:2305:12)\n    at UserRepository.create (H:\\DACN\\backend\\src\\repositories\\base.repository.ts:45:24)\n    at GlobalUserService.addUser (H:\\DACN\\backend\\src\\services\\global\\user.service.ts:269:20)\n    at UserAdminController.createUser (H:\\DACN\\backend\\src\\modules\\user\\user.admin.controller.ts:88:20)",
        "method": "POST",
        "url": "/api/v1/admin/users",
        "statusCode": 500,
        "ip": "::ffff:127.0.0.1"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:33:35 [error]: Database error: {
        "service": "lms-backend",
        "error": "Database query failed"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.error
      [SQL_SHIM_ERROR] default null value in column "username" of relation "users" violates not-null constraint <<non-string-sql>>

      126 |         .catch((err: any) => {
      127 |         // eslint-disable-next-line no-console
    > 128 |         console.error('[SQL_SHIM_ERROR] default', err?.message, typeof sqlText === 'string' ? sqlText : '<<non-string-sql>>');
          |                 ^
      129 |         throw err;
      130 |       });
      131 |     };

      at src/tests/utils/test.utils.ts:128:17
      at PostgresQueryInterface.insert (node_modules/sequelize/src/dialects/abstract/query-interface.js:795:21)
      at model.save (node_modules/sequelize/src/model.js:4154:35)
      at Function.create (node_modules/sequelize/src/model.js:2305:12)
      at UserRepository.create (src/repositories/base.repository.ts:45:24)
      at GlobalUserService.addUser (src/services/global/user.service.ts:269:20)
      at UserAdminController.createUser (src/modules/user/user.admin.controller.ts:88:20)

    console.log
      2025-11-16 23:33:39 [error]: Error creating User: null value in column "username" of relation "users" violates not-null constraint {
        "service": "lms-backend",
        "name": "SequelizeDatabaseError",
        "parent": {
          "length": 635,
          "name": "error",
          "severity": "ERROR",
          "code": "23502",
          "detail": "Failing row contains (374cc9a3-635a-4e5e-93fc-3f8d1f317fd0, test-1763310819352-96564d@example.com, null, $2b$12$H6tdAwChjVZxm7HgpT3Kf..UiPzWjvuEqN0nUFX/HT/S5638Tz686, John, Doe, +84978650620, Test user, null, student, pending, f, null, null, null, null, null, f, null, null, null, 0, null, 1, null, null, {}, {}, null, null, null, null, null, 2025-11-16 16:33:39.607+00, 2025-11-16 16:33:39.607+00, null, null, null, null, null, null, null, null, null, null, null).",
          "schema": "public",
          "table": "users",
          "column": "username",
          "file": "execMain.c",
          "line": "1971",
          "routine": "ExecConstraints",
          "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
          "parameters": [
            "374cc9a3-635a-4e5e-93fc-3f8d1f317fd0",
            "test-1763310819352-96564d@example.com",
            "$2b$12$H6tdAwChjVZxm7HgpT3Kf..UiPzWjvuEqN0nUFX/HT/S5638Tz686",
            false,
            "John",
            "Doe",
            "+84978650620",
            "Test user",
            "student",
            "pending",
            1,
            "{}",
            "{}",
            "2025-11-16 16:33:39.607 +00:00",
            "2025-11-16 16:33:39.607 +00:00"
          ]
        },
        "original": {
          "length": 635,
          "name": "error",
          "severity": "ERROR",
          "code": "23502",
          "detail": "Failing row contains (374cc9a3-635a-4e5e-93fc-3f8d1f317fd0, test-1763310819352-96564d@example.com, null, $2b$12$H6tdAwChjVZxm7HgpT3Kf..UiPzWjvuEqN0nUFX/HT/S5638Tz686, John, Doe, +84978650620, Test user, null, student, pending, f, null, null, null, null, null, f, null, null, null, 0, null, 1, null, null, {}, {}, null, null, null, null, null, 2025-11-16 16:33:39.607+00, 2025-11-16 16:33:39.607+00, null, null, null, null, null, null, null, null, null, null, null).",
          "schema": "public",
          "table": "users",
          "column": "username",
          "file": "execMain.c",
          "line": "1971",
          "routine": "ExecConstraints",
          "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
          "parameters": [
            "374cc9a3-635a-4e5e-93fc-3f8d1f317fd0",
            "test-1763310819352-96564d@example.com",
            "$2b$12$H6tdAwChjVZxm7HgpT3Kf..UiPzWjvuEqN0nUFX/HT/S5638Tz686",
            false,
            "John",
            "Doe",
            "+84978650620",
            "Test user",
            "student",
            "pending",
            1,
            "{}",
            "{}",
            "2025-11-16 16:33:39.607 +00:00",
            "2025-11-16 16:33:39.607 +00:00"
          ]
        },
        "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
        "parameters": [
          "374cc9a3-635a-4e5e-93fc-3f8d1f317fd0",
          "test-1763310819352-96564d@example.com",
          "$2b$12$H6tdAwChjVZxm7HgpT3Kf..UiPzWjvuEqN0nUFX/HT/S5638Tz686",
          false,
          "John",
          "Doe",
          "+84978650620",
          "Test user",
          "student",
          "pending",
          1,
          "{}",
          "{}",
          "2025-11-16 16:33:39.607 +00:00",
          "2025-11-16 16:33:39.607 +00:00"
        ],
        "stack": "Error: \n    at Query.run (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\postgres\\query.js:76:25)\n    at H:\\DACN\\backend\\node_modules\\sequelize\\src\\sequelize.js:650:28\n    at PostgresQueryInterface.insert (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\abstract\\query-interface.js:795:21)\n    at model.save (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:4154:35)\n    at Function.create (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:2305:12)\n    at UserRepository.create (H:\\DACN\\backend\\src\\repositories\\base.repository.ts:45:24)\n    at GlobalUserService.addUser (H:\\DACN\\backend\\src\\services\\global\\user.service.ts:269:20)\n    at UserAdminController.createUser (H:\\DACN\\backend\\src\\modules\\user\\user.admin.controller.ts:88:20)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:33:39 [error]: Error adding user: null value in column "username" of relation "users" violates not-null constraint {
        "service": "lms-backend",
        "name": "SequelizeDatabaseError",
        "parent": {
          "length": 635,
          "name": "error",
          "severity": "ERROR",
          "code": "23502",
          "detail": "Failing row contains (374cc9a3-635a-4e5e-93fc-3f8d1f317fd0, test-1763310819352-96564d@example.com, null, $2b$12$H6tdAwChjVZxm7HgpT3Kf..UiPzWjvuEqN0nUFX/HT/S5638Tz686, John, Doe, +84978650620, Test user, null, student, pending, f, null, null, null, null, null, f, null, null, null, 0, null, 1, null, null, {}, {}, null, null, null, null, null, 2025-11-16 16:33:39.607+00, 2025-11-16 16:33:39.607+00, null, null, null, null, null, null, null, null, null, null, null).",
          "schema": "public",
          "table": "users",
          "column": "username",
          "file": "execMain.c",
          "line": "1971",
          "routine": "ExecConstraints",
          "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
          "parameters": [
            "374cc9a3-635a-4e5e-93fc-3f8d1f317fd0",
            "test-1763310819352-96564d@example.com",
            "$2b$12$H6tdAwChjVZxm7HgpT3Kf..UiPzWjvuEqN0nUFX/HT/S5638Tz686",
            false,
            "John",
            "Doe",
            "+84978650620",
            "Test user",
            "student",
            "pending",
            1,
            "{}",
            "{}",
            "2025-11-16 16:33:39.607 +00:00",
            "2025-11-16 16:33:39.607 +00:00"
          ]
        },
        "original": {
          "length": 635,
          "name": "error",
          "severity": "ERROR",
          "code": "23502",
          "detail": "Failing row contains (374cc9a3-635a-4e5e-93fc-3f8d1f317fd0, test-1763310819352-96564d@example.com, null, $2b$12$H6tdAwChjVZxm7HgpT3Kf..UiPzWjvuEqN0nUFX/HT/S5638Tz686, John, Doe, +84978650620, Test user, null, student, pending, f, null, null, null, null, null, f, null, null, null, 0, null, 1, null, null, {}, {}, null, null, null, null, null, 2025-11-16 16:33:39.607+00, 2025-11-16 16:33:39.607+00, null, null, null, null, null, null, null, null, null, null, null).",
          "schema": "public",
          "table": "users",
          "column": "username",
          "file": "execMain.c",
          "line": "1971",
          "routine": "ExecConstraints",
          "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
          "parameters": [
            "374cc9a3-635a-4e5e-93fc-3f8d1f317fd0",
            "test-1763310819352-96564d@example.com",
            "$2b$12$H6tdAwChjVZxm7HgpT3Kf..UiPzWjvuEqN0nUFX/HT/S5638Tz686",
            false,
            "John",
            "Doe",
            "+84978650620",
            "Test user",
            "student",
            "pending",
            1,
            "{}",
            "{}",
            "2025-11-16 16:33:39.607 +00:00",
            "2025-11-16 16:33:39.607 +00:00"
          ]
        },
        "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
        "parameters": [
          "374cc9a3-635a-4e5e-93fc-3f8d1f317fd0",
          "test-1763310819352-96564d@example.com",
          "$2b$12$H6tdAwChjVZxm7HgpT3Kf..UiPzWjvuEqN0nUFX/HT/S5638Tz686",
          false,
          "John",
          "Doe",
          "+84978650620",
          "Test user",
          "student",
          "pending",
          1,
          "{}",
          "{}",
          "2025-11-16 16:33:39.607 +00:00",
          "2025-11-16 16:33:39.607 +00:00"
        ],
        "stack": "Error: \n    at Query.run (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\postgres\\query.js:76:25)\n    at H:\\DACN\\backend\\node_modules\\sequelize\\src\\sequelize.js:650:28\n    at PostgresQueryInterface.insert (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\abstract\\query-interface.js:795:21)\n    at model.save (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:4154:35)\n    at Function.create (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:2305:12)\n    at UserRepository.create (H:\\DACN\\backend\\src\\repositories\\base.repository.ts:45:24)\n    at GlobalUserService.addUser (H:\\DACN\\backend\\src\\services\\global\\user.service.ts:269:20)\n    at UserAdminController.createUser (H:\\DACN\\backend\\src\\modules\\user\\user.admin.controller.ts:88:20)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:33:39 [error]: Error creating user: null value in column "username" of relation "users" violates not-null constraint {
        "service": "lms-backend",
        "name": "SequelizeDatabaseError",
        "parent": {
          "length": 635,
          "name": "error",
          "severity": "ERROR",
          "code": "23502",
          "detail": "Failing row contains (374cc9a3-635a-4e5e-93fc-3f8d1f317fd0, test-1763310819352-96564d@example.com, null, $2b$12$H6tdAwChjVZxm7HgpT3Kf..UiPzWjvuEqN0nUFX/HT/S5638Tz686, John, Doe, +84978650620, Test user, null, student, pending, f, null, null, null, null, null, f, null, null, null, 0, null, 1, null, null, {}, {}, null, null, null, null, null, 2025-11-16 16:33:39.607+00, 2025-11-16 16:33:39.607+00, null, null, null, null, null, null, null, null, null, null, null).",
          "schema": "public",
          "table": "users",
          "column": "username",
          "file": "execMain.c",
          "line": "1971",
          "routine": "ExecConstraints",
          "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
          "parameters": [
            "374cc9a3-635a-4e5e-93fc-3f8d1f317fd0",
            "test-1763310819352-96564d@example.com",
            "$2b$12$H6tdAwChjVZxm7HgpT3Kf..UiPzWjvuEqN0nUFX/HT/S5638Tz686",
            false,
            "John",
            "Doe",
            "+84978650620",
            "Test user",
            "student",
            "pending",
            1,
            "{}",
            "{}",
            "2025-11-16 16:33:39.607 +00:00",
            "2025-11-16 16:33:39.607 +00:00"
          ]
        },
        "original": {
          "length": 635,
          "name": "error",
          "severity": "ERROR",
          "code": "23502",
          "detail": "Failing row contains (374cc9a3-635a-4e5e-93fc-3f8d1f317fd0, test-1763310819352-96564d@example.com, null, $2b$12$H6tdAwChjVZxm7HgpT3Kf..UiPzWjvuEqN0nUFX/HT/S5638Tz686, John, Doe, +84978650620, Test user, null, student, pending, f, null, null, null, null, null, f, null, null, null, 0, null, 1, null, null, {}, {}, null, null, null, null, null, 2025-11-16 16:33:39.607+00, 2025-11-16 16:33:39.607+00, null, null, null, null, null, null, null, null, null, null, null).",
          "schema": "public",
          "table": "users",
          "column": "username",
          "file": "execMain.c",
          "line": "1971",
          "routine": "ExecConstraints",
          "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
          "parameters": [
            "374cc9a3-635a-4e5e-93fc-3f8d1f317fd0",
            "test-1763310819352-96564d@example.com",
            "$2b$12$H6tdAwChjVZxm7HgpT3Kf..UiPzWjvuEqN0nUFX/HT/S5638Tz686",
            false,
            "John",
            "Doe",
            "+84978650620",
            "Test user",
            "student",
            "pending",
            1,
            "{}",
            "{}",
            "2025-11-16 16:33:39.607 +00:00",
            "2025-11-16 16:33:39.607 +00:00"
          ]
        },
        "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
        "parameters": [
          "374cc9a3-635a-4e5e-93fc-3f8d1f317fd0",
          "test-1763310819352-96564d@example.com",
          "$2b$12$H6tdAwChjVZxm7HgpT3Kf..UiPzWjvuEqN0nUFX/HT/S5638Tz686",
          false,
          "John",
          "Doe",
          "+84978650620",
          "Test user",
          "student",
          "pending",
          1,
          "{}",
          "{}",
          "2025-11-16 16:33:39.607 +00:00",
          "2025-11-16 16:33:39.607 +00:00"
        ],
        "stack": "Error: \n    at Query.run (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\postgres\\query.js:76:25)\n    at H:\\DACN\\backend\\node_modules\\sequelize\\src\\sequelize.js:650:28\n    at PostgresQueryInterface.insert (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\abstract\\query-interface.js:795:21)\n    at model.save (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:4154:35)\n    at Function.create (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:2305:12)\n    at UserRepository.create (H:\\DACN\\backend\\src\\repositories\\base.repository.ts:45:24)\n    at GlobalUserService.addUser (H:\\DACN\\backend\\src\\services\\global\\user.service.ts:269:20)\n    at UserAdminController.createUser (H:\\DACN\\backend\\src\\modules\\user\\user.admin.controller.ts:88:20)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:33:39 [error]: HTTP error occurred {
        "service": "lms-backend",
        "error": "null value in column \"username\" of relation \"users\" violates not-null constraint",
        "stack": "Error: \n    at Query.run (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\postgres\\query.js:76:25)\n    at H:\\DACN\\backend\\node_modules\\sequelize\\src\\sequelize.js:650:28\n    at PostgresQueryInterface.insert (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\abstract\\query-interface.js:795:21)\n    at model.save (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:4154:35)\n    at Function.create (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:2305:12)\n    at UserRepository.create (H:\\DACN\\backend\\src\\repositories\\base.repository.ts:45:24)\n    at GlobalUserService.addUser (H:\\DACN\\backend\\src\\services\\global\\user.service.ts:269:20)\n    at UserAdminController.createUser (H:\\DACN\\backend\\src\\modules\\user\\user.admin.controller.ts:88:20)",
        "method": "POST",
        "url": "/api/v1/admin/users",
        "statusCode": 500,
        "ip": "::ffff:127.0.0.1"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:33:39 [error]: Database error: {
        "service": "lms-backend",
        "error": "Database query failed"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:33:40 [error]: Zod validation error {
        "service": "lms-backend",
        "method": "POST",
        "path": "/",
        "issues": [
          {
            "path": [
              "email"
            ],
            "message": "Invalid email format",
            "code": "invalid_format"
          }
        ]
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:33:40 [error]: Zod validation error {
        "service": "lms-backend",
        "method": "POST",
        "path": "/",
        "issues": [
          {
            "path": [
              "password"
            ],
            "message": "Password must be at least 8 characters",
            "code": "too_small"
          },
          {
            "path": [
              "password"
            ],
            "message": "Password must contain at least one uppercase letter, one lowercase letter, one number, and one special character",
            "code": "custom"
          }
        ]
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.error
      [SQL_SHIM_ERROR] default null value in column "username" of relation "users" violates not-null constraint <<non-string-sql>>

      126 |         .catch((err: any) => {
      127 |         // eslint-disable-next-line no-console
    > 128 |         console.error('[SQL_SHIM_ERROR] default', err?.message, typeof sqlText === 'string' ? sqlText : '<<non-string-sql>>');
          |                 ^
      129 |         throw err;
      130 |       });
      131 |     };

      at src/tests/utils/test.utils.ts:128:17
      at PostgresQueryInterface.insert (node_modules/sequelize/src/dialects/abstract/query-interface.js:795:21)
      at model.save (node_modules/sequelize/src/model.js:4154:35)
      at Function.create (node_modules/sequelize/src/model.js:2305:12)
      at UserRepository.create (src/repositories/base.repository.ts:45:24)
      at GlobalUserService.addUser (src/services/global/user.service.ts:269:20)
      at UserAdminController.createUser (src/modules/user/user.admin.controller.ts:88:20)

    console.log
      2025-11-16 23:33:47 [error]: Error creating User: null value in column "username" of relation "users" violates not-null constraint {
        "service": "lms-backend",
        "name": "SequelizeDatabaseError",
        "parent": {
          "length": 618,
          "name": "error",
          "severity": "ERROR",
          "code": "23502",
          "detail": "Failing row contains (285f3657-706f-4965-8c89-a8d23ef7dd1f, delete-1763310827502@example.com, null, $2b$12$dOZ/s7uRFGOD46KN2ySShurEx6Kl47n8UYfMELSy4NYytLvW1jhTC, Delete, Me, null, null, null, student, pending, f, null, null, null, null, null, f, null, null, null, 0, null, 1, null, null, {}, {}, null, null, null, null, null, 2025-11-16 16:33:47.783+00, 2025-11-16 16:33:47.783+00, null, null, null, null, null, null, null, null, null, null, null).",
          "schema": "public",
          "table": "users",
          "column": "username",
          "file": "execMain.c",
          "line": "1971",
          "routine": "ExecConstraints",
          "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
          "parameters": [
            "285f3657-706f-4965-8c89-a8d23ef7dd1f",
            "delete-1763310827502@example.com",
            "$2b$12$dOZ/s7uRFGOD46KN2ySShurEx6Kl47n8UYfMELSy4NYytLvW1jhTC",
            false,
            "Delete",
            "Me",
            "student",
            "pending",
            1,
            "{}",
            "{}",
            "2025-11-16 16:33:47.783 +00:00",
            "2025-11-16 16:33:47.783 +00:00"
          ]
        },
        "original": {
          "length": 618,
          "name": "error",
          "severity": "ERROR",
          "code": "23502",
          "detail": "Failing row contains (285f3657-706f-4965-8c89-a8d23ef7dd1f, delete-1763310827502@example.com, null, $2b$12$dOZ/s7uRFGOD46KN2ySShurEx6Kl47n8UYfMELSy4NYytLvW1jhTC, Delete, Me, null, null, null, student, pending, f, null, null, null, null, null, f, null, null, null, 0, null, 1, null, null, {}, {}, null, null, null, null, null, 2025-11-16 16:33:47.783+00, 2025-11-16 16:33:47.783+00, null, null, null, null, null, null, null, null, null, null, null).",
          "schema": "public",
          "table": "users",
          "column": "username",
          "file": "execMain.c",
          "line": "1971",
          "routine": "ExecConstraints",
          "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
          "parameters": [
            "285f3657-706f-4965-8c89-a8d23ef7dd1f",
            "delete-1763310827502@example.com",
            "$2b$12$dOZ/s7uRFGOD46KN2ySShurEx6Kl47n8UYfMELSy4NYytLvW1jhTC",
            false,
            "Delete",
            "Me",
            "student",
            "pending",
            1,
            "{}",
            "{}",
            "2025-11-16 16:33:47.783 +00:00",
            "2025-11-16 16:33:47.783 +00:00"
          ]
        },
        "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
        "parameters": [
          "285f3657-706f-4965-8c89-a8d23ef7dd1f",
          "delete-1763310827502@example.com",
          "$2b$12$dOZ/s7uRFGOD46KN2ySShurEx6Kl47n8UYfMELSy4NYytLvW1jhTC",
          false,
          "Delete",
          "Me",
          "student",
          "pending",
          1,
          "{}",
          "{}",
          "2025-11-16 16:33:47.783 +00:00",
          "2025-11-16 16:33:47.783 +00:00"
        ],
        "stack": "Error: \n    at Query.run (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\postgres\\query.js:76:25)\n    at H:\\DACN\\backend\\node_modules\\sequelize\\src\\sequelize.js:650:28\n    at PostgresQueryInterface.insert (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\abstract\\query-interface.js:795:21)\n    at model.save (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:4154:35)\n    at Function.create (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:2305:12)\n    at UserRepository.create (H:\\DACN\\backend\\src\\repositories\\base.repository.ts:45:24)\n    at GlobalUserService.addUser (H:\\DACN\\backend\\src\\services\\global\\user.service.ts:269:20)\n    at UserAdminController.createUser (H:\\DACN\\backend\\src\\modules\\user\\user.admin.controller.ts:88:20)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:33:47 [error]: Error adding user: null value in column "username" of relation "users" violates not-null constraint {
        "service": "lms-backend",
        "name": "SequelizeDatabaseError",
        "parent": {
          "length": 618,
          "name": "error",
          "severity": "ERROR",
          "code": "23502",
          "detail": "Failing row contains (285f3657-706f-4965-8c89-a8d23ef7dd1f, delete-1763310827502@example.com, null, $2b$12$dOZ/s7uRFGOD46KN2ySShurEx6Kl47n8UYfMELSy4NYytLvW1jhTC, Delete, Me, null, null, null, student, pending, f, null, null, null, null, null, f, null, null, null, 0, null, 1, null, null, {}, {}, null, null, null, null, null, 2025-11-16 16:33:47.783+00, 2025-11-16 16:33:47.783+00, null, null, null, null, null, null, null, null, null, null, null).",
          "schema": "public",
          "table": "users",
          "column": "username",
          "file": "execMain.c",
          "line": "1971",
          "routine": "ExecConstraints",
          "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
          "parameters": [
            "285f3657-706f-4965-8c89-a8d23ef7dd1f",
            "delete-1763310827502@example.com",
            "$2b$12$dOZ/s7uRFGOD46KN2ySShurEx6Kl47n8UYfMELSy4NYytLvW1jhTC",
            false,
            "Delete",
            "Me",
            "student",
            "pending",
            1,
            "{}",
            "{}",
            "2025-11-16 16:33:47.783 +00:00",
            "2025-11-16 16:33:47.783 +00:00"
          ]
        },
        "original": {
          "length": 618,
          "name": "error",
          "severity": "ERROR",
          "code": "23502",
          "detail": "Failing row contains (285f3657-706f-4965-8c89-a8d23ef7dd1f, delete-1763310827502@example.com, null, $2b$12$dOZ/s7uRFGOD46KN2ySShurEx6Kl47n8UYfMELSy4NYytLvW1jhTC, Delete, Me, null, null, null, student, pending, f, null, null, null, null, null, f, null, null, null, 0, null, 1, null, null, {}, {}, null, null, null, null, null, 2025-11-16 16:33:47.783+00, 2025-11-16 16:33:47.783+00, null, null, null, null, null, null, null, null, null, null, null).",
          "schema": "public",
          "table": "users",
          "column": "username",
          "file": "execMain.c",
          "line": "1971",
          "routine": "ExecConstraints",
          "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
          "parameters": [
            "285f3657-706f-4965-8c89-a8d23ef7dd1f",
            "delete-1763310827502@example.com",
            "$2b$12$dOZ/s7uRFGOD46KN2ySShurEx6Kl47n8UYfMELSy4NYytLvW1jhTC",
            false,
            "Delete",
            "Me",
            "student",
            "pending",
            1,
            "{}",
            "{}",
            "2025-11-16 16:33:47.783 +00:00",
            "2025-11-16 16:33:47.783 +00:00"
          ]
        },
        "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
        "parameters": [
          "285f3657-706f-4965-8c89-a8d23ef7dd1f",
          "delete-1763310827502@example.com",
          "$2b$12$dOZ/s7uRFGOD46KN2ySShurEx6Kl47n8UYfMELSy4NYytLvW1jhTC",
          false,
          "Delete",
          "Me",
          "student",
          "pending",
          1,
          "{}",
          "{}",
          "2025-11-16 16:33:47.783 +00:00",
          "2025-11-16 16:33:47.783 +00:00"
        ],
        "stack": "Error: \n    at Query.run (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\postgres\\query.js:76:25)\n    at H:\\DACN\\backend\\node_modules\\sequelize\\src\\sequelize.js:650:28\n    at PostgresQueryInterface.insert (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\abstract\\query-interface.js:795:21)\n    at model.save (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:4154:35)\n    at Function.create (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:2305:12)\n    at UserRepository.create (H:\\DACN\\backend\\src\\repositories\\base.repository.ts:45:24)\n    at GlobalUserService.addUser (H:\\DACN\\backend\\src\\services\\global\\user.service.ts:269:20)\n    at UserAdminController.createUser (H:\\DACN\\backend\\src\\modules\\user\\user.admin.controller.ts:88:20)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:33:47 [error]: Error creating user: null value in column "username" of relation "users" violates not-null constraint {
        "service": "lms-backend",
        "name": "SequelizeDatabaseError",
        "parent": {
          "length": 618,
          "name": "error",
          "severity": "ERROR",
          "code": "23502",
          "detail": "Failing row contains (285f3657-706f-4965-8c89-a8d23ef7dd1f, delete-1763310827502@example.com, null, $2b$12$dOZ/s7uRFGOD46KN2ySShurEx6Kl47n8UYfMELSy4NYytLvW1jhTC, Delete, Me, null, null, null, student, pending, f, null, null, null, null, null, f, null, null, null, 0, null, 1, null, null, {}, {}, null, null, null, null, null, 2025-11-16 16:33:47.783+00, 2025-11-16 16:33:47.783+00, null, null, null, null, null, null, null, null, null, null, null).",
          "schema": "public",
          "table": "users",
          "column": "username",
          "file": "execMain.c",
          "line": "1971",
          "routine": "ExecConstraints",
          "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
          "parameters": [
            "285f3657-706f-4965-8c89-a8d23ef7dd1f",
            "delete-1763310827502@example.com",
            "$2b$12$dOZ/s7uRFGOD46KN2ySShurEx6Kl47n8UYfMELSy4NYytLvW1jhTC",
            false,
            "Delete",
            "Me",
            "student",
            "pending",
            1,
            "{}",
            "{}",
            "2025-11-16 16:33:47.783 +00:00",
            "2025-11-16 16:33:47.783 +00:00"
          ]
        },
        "original": {
          "length": 618,
          "name": "error",
          "severity": "ERROR",
          "code": "23502",
          "detail": "Failing row contains (285f3657-706f-4965-8c89-a8d23ef7dd1f, delete-1763310827502@example.com, null, $2b$12$dOZ/s7uRFGOD46KN2ySShurEx6Kl47n8UYfMELSy4NYytLvW1jhTC, Delete, Me, null, null, null, student, pending, f, null, null, null, null, null, f, null, null, null, 0, null, 1, null, null, {}, {}, null, null, null, null, null, 2025-11-16 16:33:47.783+00, 2025-11-16 16:33:47.783+00, null, null, null, null, null, null, null, null, null, null, null).",
          "schema": "public",
          "table": "users",
          "column": "username",
          "file": "execMain.c",
          "line": "1971",
          "routine": "ExecConstraints",
          "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
          "parameters": [
            "285f3657-706f-4965-8c89-a8d23ef7dd1f",
            "delete-1763310827502@example.com",
            "$2b$12$dOZ/s7uRFGOD46KN2ySShurEx6Kl47n8UYfMELSy4NYytLvW1jhTC",
            false,
            "Delete",
            "Me",
            "student",
            "pending",
            1,
            "{}",
            "{}",
            "2025-11-16 16:33:47.783 +00:00",
            "2025-11-16 16:33:47.783 +00:00"
          ]
        },
        "sql": "INSERT INTO \"users\" (\"id\",\"email\",\"password\",\"email_verified\",\"first_name\",\"last_name\",\"role\",\"status\",\"token_version\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13) RETURNING \"id\",\"email\",\"username\",\"password\",\"email_verified\",\"email_verified_at\",\"email_verification_token\",\"email_verification_expires\",\"social_id\",\"social_provider\",\"first_name\",\"last_name\",\"phone\",\"bio\",\"avatar\",\"role\",\"status\",\"token_version\",\"last_login\",\"preferences\",\"metadata\",\"created_at\",\"updated_at\";",
        "parameters": [
          "285f3657-706f-4965-8c89-a8d23ef7dd1f",
          "delete-1763310827502@example.com",
          "$2b$12$dOZ/s7uRFGOD46KN2ySShurEx6Kl47n8UYfMELSy4NYytLvW1jhTC",
          false,
          "Delete",
          "Me",
          "student",
          "pending",
          1,
          "{}",
          "{}",
          "2025-11-16 16:33:47.783 +00:00",
          "2025-11-16 16:33:47.783 +00:00"
        ],
        "stack": "Error: \n    at Query.run (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\postgres\\query.js:76:25)\n    at H:\\DACN\\backend\\node_modules\\sequelize\\src\\sequelize.js:650:28\n    at PostgresQueryInterface.insert (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\abstract\\query-interface.js:795:21)\n    at model.save (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:4154:35)\n    at Function.create (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:2305:12)\n    at UserRepository.create (H:\\DACN\\backend\\src\\repositories\\base.repository.ts:45:24)\n    at GlobalUserService.addUser (H:\\DACN\\backend\\src\\services\\global\\user.service.ts:269:20)\n    at UserAdminController.createUser (H:\\DACN\\backend\\src\\modules\\user\\user.admin.controller.ts:88:20)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:33:47 [error]: HTTP error occurred {
        "service": "lms-backend",
        "error": "null value in column \"username\" of relation \"users\" violates not-null constraint",
        "stack": "Error: \n    at Query.run (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\postgres\\query.js:76:25)\n    at H:\\DACN\\backend\\node_modules\\sequelize\\src\\sequelize.js:650:28\n    at PostgresQueryInterface.insert (H:\\DACN\\backend\\node_modules\\sequelize\\src\\dialects\\abstract\\query-interface.js:795:21)\n    at model.save (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:4154:35)\n    at Function.create (H:\\DACN\\backend\\node_modules\\sequelize\\src\\model.js:2305:12)\n    at UserRepository.create (H:\\DACN\\backend\\src\\repositories\\base.repository.ts:45:24)\n    at GlobalUserService.addUser (H:\\DACN\\backend\\src\\services\\global\\user.service.ts:269:20)\n    at UserAdminController.createUser (H:\\DACN\\backend\\src\\modules\\user\\user.admin.controller.ts:88:20)",
        "method": "POST",
        "url": "/api/v1/admin/users",
        "statusCode": 500,
        "ip": "::ffff:127.0.0.1"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:33:47 [error]: Database error: {
        "service": "lms-backend",
        "error": "Database query failed"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:33:48 [error]: Error deleting User: User not found {
        "service": "lms-backend",
        "stack": "Error: User not found\n    at UserRepository.delete (H:\\DACN\\backend\\src\\repositories\\base.repository.ts:185:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at GlobalUserService.removeUser (H:\\DACN\\backend\\src\\services\\global\\user.service.ts:297:7)\n    at UserAdminController.deleteUser (H:\\DACN\\backend\\src\\modules\\user\\user.admin.controller.ts:144:7)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:33:48 [error]: Error removing user: User not found {
        "service": "lms-backend",
        "stack": "Error: User not found\n    at UserRepository.delete (H:\\DACN\\backend\\src\\repositories\\base.repository.ts:185:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at GlobalUserService.removeUser (H:\\DACN\\backend\\src\\services\\global\\user.service.ts:297:7)\n    at UserAdminController.deleteUser (H:\\DACN\\backend\\src\\modules\\user\\user.admin.controller.ts:144:7)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:33:48 [error]: Error deleting user: User not found {
        "service": "lms-backend",
        "stack": "Error: User not found\n    at UserRepository.delete (H:\\DACN\\backend\\src\\repositories\\base.repository.ts:185:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at GlobalUserService.removeUser (H:\\DACN\\backend\\src\\services\\global\\user.service.ts:297:7)\n    at UserAdminController.deleteUser (H:\\DACN\\backend\\src\\modules\\user\\user.admin.controller.ts:144:7)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

  ΓùÅ User Admin Controller - Integration Tests ΓÇ║ POST /admin/users ΓÇ║ should create a new user as admin

    expected 201 "Created", got 500 "Internal Server Error"

      175 |         .set('Authorization', `Bearer ${adminToken}`)
      176 |         .send(newUser)
    > 177 |         .expect(201);
          |          ^
      178 |
      179 |       expect(response.body.success).toBe(true);
      180 |       expect(response.body.data).toHaveProperty('id');

      at Object.<anonymous> (src/tests/integration/modules/user/user.admin.controller.test.ts:177:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:309:14)
      at node_modules/supertest/lib/test.js:365:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:342:13)
      at Test.assert (node_modules/supertest/lib/test.js:195:23)
      at localAssert (node_modules/supertest/lib/test.js:138:14)
      at Server.<anonymous> (node_modules/supertest/lib/test.js:152:11)

  ΓùÅ User Admin Controller - Integration Tests ΓÇ║ GET /admin/users/:id ΓÇ║ should get user by ID

    expected 200 "OK", got 404 "Not Found"

      241 |         .get(`/api/v1/admin/users/${testUserId}`)
      242 |         .set('Authorization', `Bearer ${adminToken}`)
    > 243 |         .expect(200);
          |          ^
      244 |
      245 |       expect(response.body.success).toBe(true);
      246 |       expect(response.body.data).toHaveProperty('id');

      at Object.<anonymous> (src/tests/integration/modules/user/user.admin.controller.test.ts:243:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:309:14)
      at node_modules/supertest/lib/test.js:365:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:342:13)
      at Test.assert (node_modules/supertest/lib/test.js:195:23)
      at localAssert (node_modules/supertest/lib/test.js:138:14)
      at Server.<anonymous> (node_modules/supertest/lib/test.js:152:11)

  ΓùÅ User Admin Controller - Integration Tests ΓÇ║ PATCH /admin/users/:id ΓÇ║ should update user as admin

    expected 200 "OK", got 404 "Not Found"

      275 |         .set('Authorization', `Bearer ${adminToken}`)
      276 |         .send(updates)
    > 277 |         .expect(200);
          |          ^
      278 |
      279 |       expect(response.body.success).toBe(true);
      280 |       expect(response.body.data.first_name).toBe(updates.first_name);

      at Object.<anonymous> (src/tests/integration/modules/user/user.admin.controller.test.ts:277:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:309:14)
      at node_modules/supertest/lib/test.js:365:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:342:13)
      at Test.assert (node_modules/supertest/lib/test.js:195:23)
      at localAssert (node_modules/supertest/lib/test.js:138:14)
      at Server.<anonymous> (node_modules/supertest/lib/test.js:152:11)

  ΓùÅ User Admin Controller - Integration Tests ΓÇ║ PATCH /admin/users/:id/status ΓÇ║ should change user status as admin

    expected 200 "OK", got 404 "Not Found"

      296 |         .set('Authorization', `Bearer ${adminToken}`)
      297 |         .send({ status: 'suspended' })
    > 298 |         .expect(200);
          |          ^
      299 |
      300 |       expect(response.body.success).toBe(true);
      301 |       expect(response.body.data.status).toBe('suspended');

      at Object.<anonymous> (src/tests/integration/modules/user/user.admin.controller.test.ts:298:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:309:14)
      at node_modules/supertest/lib/test.js:365:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:342:13)
      at Test.assert (node_modules/supertest/lib/test.js:195:23)
      at localAssert (node_modules/supertest/lib/test.js:138:14)
      at Server.<anonymous> (node_modules/supertest/lib/test.js:152:11)

  ΓùÅ User Admin Controller - Integration Tests ΓÇ║ PATCH /admin/users/:id/status ΓÇ║ should validate status values

    expected 400 "Bad Request", got 404 "Not Found"

      307 |         .set('Authorization', `Bearer ${adminToken}`)
      308 |         .send({ status: 'invalid_status' })
    > 309 |         .expect(400);
          |          ^
      310 |     });
      311 |
      312 |     it('should deny access for non-admin users', async () => {

      at Object.<anonymous> (src/tests/integration/modules/user/user.admin.controller.test.ts:309:10)
      ----
      at Test._assertStatus (node_modules/supertest/lib/test.js:309:14)
      at node_modules/supertest/lib/test.js:365:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:342:13)
      at Test.assert (node_modules/supertest/lib/test.js:195:23)
      at localAssert (node_modules/supertest/lib/test.js:138:14)
      at Server.<anonymous> (node_modules/supertest/lib/test.js:152:11)

  ΓùÅ User Admin Controller - Integration Tests ΓÇ║ DELETE /admin/users/:id ΓÇ║ should delete user as admin

    TypeError: Cannot read properties of undefined (reading 'id')

      389 |         });
      390 |
    > 391 |       const deleteUserId = userToDelete.body.data.id;
          |                                                   ^
      392 |
      393 |       await request(app)
      394 |         .delete(`/api/v1/admin/users/${deleteUserId}`)

      at Object.<anonymous> (src/tests/integration/modules/user/user.admin.controller.test.ts:391:51)

FAIL src/tests/integration/modules/assignment/assignment.service.integration.test.ts
  ΓùÅ Console

    console.log
      [dotenv@17.2.3] injecting env (25) from src\tests\integration\test.env -- tip: ≡ƒùé∩╕Å backup and recover secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

    console.log
      Γ£à Model associations setup completed

      at log (src/models/associations.ts:263:11)

    console.log
      Γ£à Extended model associations setup completed

      at log (src/models/associations-extended.ts:340:11)

    console.log
      2025-11-16 23:33:50 [error]: Error creating assignment: Error: Only the course instructor can perform this action (Code: AUTH_INSUFFICIENT_PERMISSIONS, Status: 403) {
        "service": "lms-backend"
      }

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:33:51 [error]: Error submitting assignment: Error: Assignment already submitted (Code: INTERNAL_SERVER_ERROR, Status: 400) {
        "service": "lms-backend"
      }

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:33:51 [error]: Error grading submission: SequelizeEagerLoadingError: User is associated to AssignmentSubmission multiple times. To identify the correct association, you must use the 'as' keyword to specify the alias of the association you want to include. {
        "service": "lms-backend"
      }

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

  ΓùÅ AssignmentService Integration ΓÇ║ should allow instructors to grade submissions and reject unauthorized graders

    SequelizeEagerLoadingError: User is associated to AssignmentSubmission multiple times. To identify the correct association, you must use the 'as' keyword to specify the alias of the association you want to include.

      247 |       }
      248 |
    > 249 |       const graded = await this.repo.grade(submissionId, { ...data, graded_by: graderId });
          |                      ^
      250 |       logger.info(`Submission graded: ${submissionId} by user ${graderId}`);
      251 |       return graded;
      252 |     } catch (error: unknown) {

      at Function._getIncludedAssociation (node_modules/sequelize/src/model.js:759:13)
      at Function._validateIncludedElement (node_modules/sequelize/src/model.js:646:53)
      at node_modules/sequelize/src/model.js:542:37
          at Array.map (<anonymous>)
      at Function._validateIncludedElements (node_modules/sequelize/src/model.js:537:39)
      at Function.findAll (node_modules/sequelize/src/model.js:1794:12)
      at Function.findOne (node_modules/sequelize/src/model.js:1998:12)
      at Function.findByPk (node_modules/sequelize/src/model.js:1955:12)
      at AssignmentService.gradeSubmission (src/modules/assignment/assignment.service.ts:249:22)
      at Object.<anonymous> (src/tests/integration/modules/assignment/assignment.service.integration.test.ts:150:20)

PASS src/tests/integration/api/user.integration.test.ts (27.535 s)
  ΓùÅ Console

    console.log
      [dotenv@17.2.3] injecting env (25) from src\tests\integration\test.env -- tip: ≡ƒöæ add access controls to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

    console.log
      Γ£à Model associations setup completed

      at log (src/models/associations.ts:263:11)

    console.log
      Γ£à Extended model associations setup completed

      at log (src/models/associations-extended.ts:340:11)

    console.log
      [API_ROUTE_DEBUG_COUNT] 4

      at Object.<anonymous> (src/app.ts:150:11)

    console.log
      [API_ROUTE_DEBUG_LIST] [
        'GET /users/profile',
        'PUT /users/profile',
        'PUT /users/change-password',
        'GET /__routes_debug'
      ]

      at Object.<anonymous> (src/app.ts:152:11)

    console.log
      OpenTelemetry tracing started (local only, no OTLP export)

      at log (src/tracing/tracing.ts:45:15)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      2025-11-16 23:33:55 [error]: JWT verify token error: jwt malformed {
        "service": "lms-backend",
        "name": "JsonWebTokenError",
        "stack": "JsonWebTokenError: jwt malformed\n    at Object.module.exports [as verify] (H:\\DACN\\backend\\node_modules\\jsonwebtoken\\verify.js:70:17)\n    at Object.verify [as verifyToken] (H:\\DACN\\backend\\src\\utils\\jwt.util.ts:87:27)\n    at Object.verifyToken [as verifyAccessToken] (H:\\DACN\\backend\\src\\utils\\token.util.ts:112:34)\n    at verifyAccessToken (H:\\DACN\\backend\\src\\middlewares\\auth.middleware.ts:35:38)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:157:13)\n    at Route.dispatch (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:117:3)\n    at handle (H:\\DACN\\backend\\node_modules\\router\\index.js:435:11)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:295:15\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:688:15\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:276:14)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at urlencodedParser (H:\\DACN\\backend\\node_modules\\body-parser\\lib\\types\\urlencoded.js:68:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at jsonParser (H:\\DACN\\backend\\node_modules\\body-parser\\lib\\types\\json.js:100:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at cors (H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:188:7)\n    at H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:224:17\n    at callback (H:\\DACN\\backend\\src\\config\\cors.config.ts:8:7)\n    at H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:219:13\n    at optionsCallback (H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:199:9)\n    at corsMiddleware (H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:204:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:531:6)\n    at xXssProtectionMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:311:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xPoweredByMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:304:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xPermittedCrossDomainPoliciesMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:297:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xFrameOptionsMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:281:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xDownloadOptionsMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:261:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xDnsPrefetchControlMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:254:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xContentTypeOptionsMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:246:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at strictTransportSecurityMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:239:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at referrerPolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:207:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at originAgentClusterMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:182:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at crossOriginResourcePolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:175:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at crossOriginOpenerPolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:159:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at contentSecurityPolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:124:4)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at helmetMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:533:6)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at next (H:\\DACN\\backend\\src\\monitoring\\metrics\\metrics.middleware.ts:238:5)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at next (H:\\DACN\\backend\\src\\monitoring\\metrics\\metrics.middleware.ts:217:5)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at next (H:\\DACN\\backend\\src\\monitoring\\metrics\\metrics.middleware.ts:196:5)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:33:55 [error]: Access token verification error: Token verification failed {
        "service": "lms-backend",
        "stack": "Error: Token verification failed\n    at Object.verifyToken (H:\\DACN\\backend\\src\\utils\\jwt.util.ts:90:13)\n    at Object.verifyToken [as verifyAccessToken] (H:\\DACN\\backend\\src\\utils\\token.util.ts:112:34)\n    at verifyAccessToken (H:\\DACN\\backend\\src\\middlewares\\auth.middleware.ts:35:38)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:157:13)\n    at Route.dispatch (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:117:3)\n    at handle (H:\\DACN\\backend\\node_modules\\router\\index.js:435:11)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:295:15\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:688:15\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:276:14)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at urlencodedParser (H:\\DACN\\backend\\node_modules\\body-parser\\lib\\types\\urlencoded.js:68:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at jsonParser (H:\\DACN\\backend\\node_modules\\body-parser\\lib\\types\\json.js:100:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at cors (H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:188:7)\n    at H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:224:17\n    at callback (H:\\DACN\\backend\\src\\config\\cors.config.ts:8:7)\n    at H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:219:13\n    at optionsCallback (H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:199:9)\n    at corsMiddleware (H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:204:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:531:6)\n    at xXssProtectionMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:311:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xPoweredByMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:304:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xPermittedCrossDomainPoliciesMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:297:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xFrameOptionsMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:281:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xDownloadOptionsMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:261:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xDnsPrefetchControlMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:254:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xContentTypeOptionsMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:246:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at strictTransportSecurityMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:239:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at referrerPolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:207:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at originAgentClusterMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:182:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at crossOriginResourcePolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:175:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at crossOriginOpenerPolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:159:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at contentSecurityPolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:124:4)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at helmetMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:533:6)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at next (H:\\DACN\\backend\\src\\monitoring\\metrics\\metrics.middleware.ts:238:5)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at next (H:\\DACN\\backend\\src\\monitoring\\metrics\\metrics.middleware.ts:217:5)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at next (H:\\DACN\\backend\\src\\monitoring\\metrics\\metrics.middleware.ts:196:5)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:33:55 [error]: Token verification failed: Invalid access token {
        "service": "lms-backend",
        "stack": "Error: Invalid access token\n    at Object.verifyAccessToken (H:\\DACN\\backend\\src\\utils\\token.util.ts:128:15)\n    at verifyAccessToken (H:\\DACN\\backend\\src\\middlewares\\auth.middleware.ts:35:38)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:157:13)\n    at Route.dispatch (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:117:3)\n    at handle (H:\\DACN\\backend\\node_modules\\router\\index.js:435:11)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:295:15\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:688:15\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:276:14)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at urlencodedParser (H:\\DACN\\backend\\node_modules\\body-parser\\lib\\types\\urlencoded.js:68:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at jsonParser (H:\\DACN\\backend\\node_modules\\body-parser\\lib\\types\\json.js:100:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at cors (H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:188:7)\n    at H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:224:17\n    at callback (H:\\DACN\\backend\\src\\config\\cors.config.ts:8:7)\n    at H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:219:13\n    at optionsCallback (H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:199:9)\n    at corsMiddleware (H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:204:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:531:6)\n    at xXssProtectionMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:311:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xPoweredByMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:304:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xPermittedCrossDomainPoliciesMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:297:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xFrameOptionsMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:281:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xDownloadOptionsMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:261:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xDnsPrefetchControlMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:254:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xContentTypeOptionsMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:246:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at strictTransportSecurityMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:239:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at referrerPolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:207:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at originAgentClusterMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:182:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at crossOriginResourcePolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:175:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at crossOriginOpenerPolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:159:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at contentSecurityPolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:124:4)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at helmetMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:533:6)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at next (H:\\DACN\\backend\\src\\monitoring\\metrics\\metrics.middleware.ts:238:5)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at next (H:\\DACN\\backend\\src\\monitoring\\metrics\\metrics.middleware.ts:217:5)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at next (H:\\DACN\\backend\\src\\monitoring\\metrics\\metrics.middleware.ts:196:5)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      2025-11-16 23:33:57 [error]: Zod validation error {
        "service": "lms-backend",
        "method": "PUT",
        "path": "/users/profile",
        "issues": [
          {
            "path": [
              "first_name"
            ],
            "message": "Name must be at least 2 characters",
            "code": "too_small"
          },
          {
            "path": [
              "first_name"
            ],
            "message": "Name can only contain letters and spaces",
            "code": "invalid_format"
          },
          {
            "path": [
              "bio"
            ],
            "message": "Bio must be less than 500 characters",
            "code": "too_big"
          }
        ]
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      2025-11-16 23:34:01 [error]: Error changing password: Invalid current password {
        "service": "lms-backend",
        "code": "VALIDATION_FAILED",
        "statusCode": 400,
        "type": "VALIDATION",
        "severity": "MEDIUM",
        "isOperational": true,
        "details": {},
        "context": {},
        "stack": "Error: Invalid current password\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.badRequest (H:\\DACN\\backend\\src\\errors\\api.error.ts:72:12)\n    at AuthModuleService.badRequest [as changePassword] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:244:24)\n    at AuthController.changePassword (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:153:7)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:01 [error]: Error changing password: Invalid current password {
        "service": "lms-backend",
        "code": "VALIDATION_FAILED",
        "statusCode": 400,
        "type": "VALIDATION",
        "severity": "MEDIUM",
        "isOperational": true,
        "details": {},
        "context": {},
        "stack": "Error: Invalid current password\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.badRequest (H:\\DACN\\backend\\src\\errors\\api.error.ts:72:12)\n    at AuthModuleService.badRequest [as changePassword] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:244:24)\n    at AuthController.changePassword (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:153:7)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:01 [error]: HTTP error occurred {
        "service": "lms-backend",
        "error": "Invalid current password",
        "stack": "Error: Invalid current password\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.badRequest (H:\\DACN\\backend\\src\\errors\\api.error.ts:72:12)\n    at AuthModuleService.badRequest [as changePassword] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:244:24)\n    at AuthController.changePassword (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:153:7)",
        "method": "PUT",
        "url": "/api/users/change-password",
        "statusCode": 400,
        "ip": "::ffff:127.0.0.1"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      2025-11-16 23:34:02 [error]: Zod validation error {
        "service": "lms-backend",
        "method": "PUT",
        "path": "/users/change-password",
        "issues": [
          {
            "path": [
              "confirmPassword"
            ],
            "message": "Passwords don't match",
            "code": "custom"
          }
        ]
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      2025-11-16 23:34:03 [error]: Zod validation error {
        "service": "lms-backend",
        "method": "PUT",
        "path": "/users/change-password",
        "issues": [
          {
            "path": [
              "newPassword"
            ],
            "message": "Password must be at least 8 characters",
            "code": "too_small"
          },
          {
            "path": [
              "newPassword"
            ],
            "message": "Password must contain at least one uppercase letter, one lowercase letter, one number, and one special character",
            "code": "custom"
          }
        ]
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      2025-11-16 23:34:15 [error]: Zod validation error {
        "service": "lms-backend",
        "method": "PUT",
        "path": "/6cab6318-8fe3-4def-a4dc-b06348336606/status",
        "issues": [
          {
            "path": [
              "status"
            ],
            "message": "Invalid option: expected one of \"active\"|\"inactive\"|\"suspended\"|\"pending\"",
            "code": "invalid_value",
            "values": [
              "active",
              "inactive",
              "suspended",
              "pending"
            ]
          }
        ]
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      2025-11-16 23:34:19 [error]: Zod validation error {
        "service": "lms-backend",
        "method": "PUT",
        "path": "/b5aa9f2d-24ba-4f54-a2f7-2df0e76006f7/role",
        "issues": [
          {
            "path": [
              "role"
            ],
            "message": "Invalid option: expected one of \"student\"|\"instructor\"|\"admin\"|\"super_admin\"",
            "code": "invalid_value",
            "values": [
              "student",
              "instructor",
              "admin",
              "super_admin"
            ]
          }
        ]
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id IN ($1, $2)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

PASS src/tests/integration/api/auth.integration.test.ts (16.271 s)
  ΓùÅ Console

    console.log
      [dotenv@17.2.3] injecting env (25) from src\tests\integration\test.env -- tip: ΓÜÖ∩╕Å  write to custom object with { processEnv: myObject }

      at _log (node_modules/dotenv/lib/main.js:142:11)

    console.log
      Γ£à Model associations setup completed

      at log (src/models/associations.ts:263:11)

    console.log
      Γ£à Extended model associations setup completed

      at log (src/models/associations-extended.ts:340:11)

    console.log
      [API_ROUTE_DEBUG_COUNT] 4

      at Object.<anonymous> (src/app.ts:150:11)

    console.log
      [API_ROUTE_DEBUG_LIST] [
        'GET /users/profile',
        'PUT /users/profile',
        'PUT /users/change-password',
        'GET /__routes_debug'
      ]

      at Object.<anonymous> (src/app.ts:152:11)

    console.log
      OpenTelemetry tracing started (local only, no OTLP export)

      at log (src/tracing/tracing.ts:45:15)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE email IN ($1, $2) OR username IN ($3, $4)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE email IN ($1, $2) OR username IN ($3, $4)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      2025-11-16 23:34:22 [error]: Error registering user: email already exists {
        "service": "lms-backend",
        "code": "VALIDATION_FAILED",
        "statusCode": 400,
        "type": "VALIDATION",
        "severity": "MEDIUM",
        "isOperational": true,
        "details": {},
        "context": {},
        "stack": "Error: email already exists\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.badRequest (H:\\DACN\\backend\\src\\errors\\api.error.ts:72:12)\n    at AuthModuleService.badRequest [as register] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:32:24)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at AuthController.register (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:19:22)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:22 [error]: Error during registration: email already exists {
        "service": "lms-backend",
        "code": "VALIDATION_FAILED",
        "statusCode": 400,
        "type": "VALIDATION",
        "severity": "MEDIUM",
        "isOperational": true,
        "details": {},
        "context": {},
        "stack": "Error: email already exists\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.badRequest (H:\\DACN\\backend\\src\\errors\\api.error.ts:72:12)\n    at AuthModuleService.badRequest [as register] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:32:24)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at AuthController.register (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:19:22)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:22 [error]: HTTP error occurred {
        "service": "lms-backend",
        "error": "email already exists",
        "stack": "Error: email already exists\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.badRequest (H:\\DACN\\backend\\src\\errors\\api.error.ts:72:12)\n    at AuthModuleService.badRequest [as register] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:32:24)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at AuthController.register (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:19:22)",
        "method": "POST",
        "url": "/api/auth/register",
        "statusCode": 400,
        "ip": "::ffff:127.0.0.1"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE email IN ($1, $2) OR username IN ($3, $4)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      2025-11-16 23:34:23 [error]: Error registering user: username already exists {
        "service": "lms-backend",
        "code": "VALIDATION_FAILED",
        "statusCode": 400,
        "type": "VALIDATION",
        "severity": "MEDIUM",
        "isOperational": true,
        "details": {},
        "context": {},
        "stack": "Error: username already exists\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.badRequest (H:\\DACN\\backend\\src\\errors\\api.error.ts:72:12)\n    at AuthModuleService.badRequest [as register] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:39:24)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at AuthController.register (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:19:22)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:23 [error]: Error during registration: username already exists {
        "service": "lms-backend",
        "code": "VALIDATION_FAILED",
        "statusCode": 400,
        "type": "VALIDATION",
        "severity": "MEDIUM",
        "isOperational": true,
        "details": {},
        "context": {},
        "stack": "Error: username already exists\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.badRequest (H:\\DACN\\backend\\src\\errors\\api.error.ts:72:12)\n    at AuthModuleService.badRequest [as register] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:39:24)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at AuthController.register (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:19:22)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:23 [error]: HTTP error occurred {
        "service": "lms-backend",
        "error": "username already exists",
        "stack": "Error: username already exists\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.badRequest (H:\\DACN\\backend\\src\\errors\\api.error.ts:72:12)\n    at AuthModuleService.badRequest [as register] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:39:24)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at AuthController.register (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:19:22)",
        "method": "POST",
        "url": "/api/auth/register",
        "statusCode": 400,
        "ip": "::ffff:127.0.0.1"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE email IN ($1, $2) OR username IN ($3, $4)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      2025-11-16 23:34:24 [error]: Zod validation error {
        "service": "lms-backend",
        "method": "POST",
        "path": "/register",
        "issues": [
          {
            "path": [
              "email"
            ],
            "message": "Invalid email format",
            "code": "invalid_format"
          }
        ]
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE email IN ($1, $2) OR username IN ($3, $4)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      2025-11-16 23:34:24 [error]: Zod validation error {
        "service": "lms-backend",
        "method": "POST",
        "path": "/register",
        "issues": [
          {
            "path": [
              "password"
            ],
            "message": "Password must be at least 8 characters",
            "code": "too_small"
          },
          {
            "path": [
              "password"
            ],
            "message": "Password must contain at least one uppercase letter, one lowercase letter, one number, and one special character",
            "code": "custom"
          }
        ]
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE email IN ($1, $2) OR username IN ($3, $4)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE email IN ($1, $2) OR username IN ($3, $4)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      2025-11-16 23:34:26 [error]: Error logging in user: Invalid credentials {
        "service": "lms-backend",
        "code": "AUTH_TOKEN_MISSING",
        "statusCode": 401,
        "type": "AUTHENTICATION",
        "severity": "MEDIUM",
        "isOperational": true,
        "details": {},
        "context": {},
        "stack": "Error: Invalid credentials\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.unauthorized (H:\\DACN\\backend\\src\\errors\\api.error.ts:86:12)\n    at AuthModuleService.unauthorized [as login] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:93:24)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at AuthController.login (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:35:22)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:26 [error]: Error during login: Invalid credentials {
        "service": "lms-backend",
        "code": "AUTH_TOKEN_MISSING",
        "statusCode": 401,
        "type": "AUTHENTICATION",
        "severity": "MEDIUM",
        "isOperational": true,
        "details": {},
        "context": {},
        "stack": "Error: Invalid credentials\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.unauthorized (H:\\DACN\\backend\\src\\errors\\api.error.ts:86:12)\n    at AuthModuleService.unauthorized [as login] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:93:24)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at AuthController.login (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:35:22)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:26 [error]: HTTP error occurred {
        "service": "lms-backend",
        "error": "Invalid credentials",
        "stack": "Error: Invalid credentials\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.unauthorized (H:\\DACN\\backend\\src\\errors\\api.error.ts:86:12)\n    at AuthModuleService.unauthorized [as login] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:93:24)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at AuthController.login (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:35:22)",
        "method": "POST",
        "url": "/api/auth/login",
        "statusCode": 401,
        "ip": "::ffff:127.0.0.1"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE email IN ($1, $2) OR username IN ($3, $4)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      2025-11-16 23:34:27 [error]: Error logging in user: Invalid credentials. 4 attempts remaining {
        "service": "lms-backend",
        "code": "AUTH_TOKEN_MISSING",
        "statusCode": 401,
        "type": "AUTHENTICATION",
        "severity": "MEDIUM",
        "isOperational": true,
        "details": {},
        "context": {},
        "stack": "Error: Invalid credentials. 4 attempts remaining\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.unauthorized (H:\\DACN\\backend\\src\\errors\\api.error.ts:86:12)\n    at AuthModuleService.unauthorized [as login] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:107:24)\n    at AuthController.login (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:35:22)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:27 [error]: Error during login: Invalid credentials. 4 attempts remaining {
        "service": "lms-backend",
        "code": "AUTH_TOKEN_MISSING",
        "statusCode": 401,
        "type": "AUTHENTICATION",
        "severity": "MEDIUM",
        "isOperational": true,
        "details": {},
        "context": {},
        "stack": "Error: Invalid credentials. 4 attempts remaining\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.unauthorized (H:\\DACN\\backend\\src\\errors\\api.error.ts:86:12)\n    at AuthModuleService.unauthorized [as login] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:107:24)\n    at AuthController.login (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:35:22)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:27 [error]: HTTP error occurred {
        "service": "lms-backend",
        "error": "Invalid credentials. 4 attempts remaining",
        "stack": "Error: Invalid credentials. 4 attempts remaining\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.unauthorized (H:\\DACN\\backend\\src\\errors\\api.error.ts:86:12)\n    at AuthModuleService.unauthorized [as login] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:107:24)\n    at AuthController.login (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:35:22)",
        "method": "POST",
        "url": "/api/auth/login",
        "statusCode": 401,
        "ip": "::ffff:127.0.0.1"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE email IN ($1, $2) OR username IN ($3, $4)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      2025-11-16 23:34:28 [error]: Error logging in user: Account is inactive {
        "service": "lms-backend",
        "code": "AUTH_INSUFFICIENT_PERMISSIONS",
        "statusCode": 403,
        "type": "AUTHORIZATION",
        "severity": "MEDIUM",
        "isOperational": true,
        "details": {},
        "context": {},
        "stack": "Error: Account is inactive\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.forbidden (H:\\DACN\\backend\\src\\errors\\api.error.ts:100:12)\n    at AuthModuleService.forbidden [as login] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:112:24)\n    at AuthController.login (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:35:22)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:28 [error]: Error during login: Account is inactive {
        "service": "lms-backend",
        "code": "AUTH_INSUFFICIENT_PERMISSIONS",
        "statusCode": 403,
        "type": "AUTHORIZATION",
        "severity": "MEDIUM",
        "isOperational": true,
        "details": {},
        "context": {},
        "stack": "Error: Account is inactive\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.forbidden (H:\\DACN\\backend\\src\\errors\\api.error.ts:100:12)\n    at AuthModuleService.forbidden [as login] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:112:24)\n    at AuthController.login (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:35:22)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:28 [error]: HTTP error occurred {
        "service": "lms-backend",
        "error": "Account is inactive",
        "stack": "Error: Account is inactive\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.forbidden (H:\\DACN\\backend\\src\\errors\\api.error.ts:100:12)\n    at AuthModuleService.forbidden [as login] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:112:24)\n    at AuthController.login (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:35:22)",
        "method": "POST",
        "url": "/api/auth/login",
        "statusCode": 403,
        "ip": "::ffff:127.0.0.1"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE email IN ($1, $2) OR username IN ($3, $4)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      2025-11-16 23:34:30 [error]: Error logging in user: Account is inactive {
        "service": "lms-backend",
        "code": "AUTH_INSUFFICIENT_PERMISSIONS",
        "statusCode": 403,
        "type": "AUTHORIZATION",
        "severity": "MEDIUM",
        "isOperational": true,
        "details": {},
        "context": {},
        "stack": "Error: Account is inactive\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.forbidden (H:\\DACN\\backend\\src\\errors\\api.error.ts:100:12)\n    at AuthModuleService.forbidden [as login] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:112:24)\n    at AuthController.login (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:35:22)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:30 [error]: Error during login: Account is inactive {
        "service": "lms-backend",
        "code": "AUTH_INSUFFICIENT_PERMISSIONS",
        "statusCode": 403,
        "type": "AUTHORIZATION",
        "severity": "MEDIUM",
        "isOperational": true,
        "details": {},
        "context": {},
        "stack": "Error: Account is inactive\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.forbidden (H:\\DACN\\backend\\src\\errors\\api.error.ts:100:12)\n    at AuthModuleService.forbidden [as login] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:112:24)\n    at AuthController.login (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:35:22)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:30 [error]: HTTP error occurred {
        "service": "lms-backend",
        "error": "Account is inactive",
        "stack": "Error: Account is inactive\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.forbidden (H:\\DACN\\backend\\src\\errors\\api.error.ts:100:12)\n    at AuthModuleService.forbidden [as login] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:112:24)\n    at AuthController.login (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:35:22)",
        "method": "POST",
        "url": "/api/auth/login",
        "statusCode": 403,
        "ip": "::ffff:127.0.0.1"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE email IN ($1, $2) OR username IN ($3, $4)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE email IN ($1, $2) OR username IN ($3, $4)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      2025-11-16 23:34:32 [error]: JWT verify token error: jwt malformed {
        "service": "lms-backend",
        "name": "JsonWebTokenError",
        "stack": "JsonWebTokenError: jwt malformed\n    at Object.module.exports [as verify] (H:\\DACN\\backend\\node_modules\\jsonwebtoken\\verify.js:70:17)\n    at Object.verify [as verifyToken] (H:\\DACN\\backend\\src\\utils\\jwt.util.ts:87:27)\n    at Object.verifyToken [as verifyRefreshToken] (H:\\DACN\\backend\\src\\utils\\token.util.ts:166:34)\n    at Object.verifyRefreshToken (H:\\DACN\\backend\\src\\utils\\jwt.util.ts:147:27)\n    at GlobalAuthService.verifyRefreshToken (H:\\DACN\\backend\\src\\services\\global\\auth.service.ts:31:29)\n    at AuthModuleService.verifyRefreshToken [as refreshToken] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:186:45)\n    at AuthController.refreshToken (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:117:45)\n    at refreshToken (H:\\DACN\\backend\\src\\modules\\auth\\auth.routes.ts:49:53)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:157:13)\n    at next (H:\\DACN\\backend\\src\\middlewares\\validate.middleware.ts:40:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:157:13)\n    at Route.dispatch (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:117:3)\n    at handle (H:\\DACN\\backend\\node_modules\\router\\index.js:435:11)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:295:15\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:688:15\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:276:14)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at urlencodedParser (H:\\DACN\\backend\\node_modules\\body-parser\\lib\\types\\urlencoded.js:57:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at H:\\DACN\\backend\\node_modules\\body-parser\\lib\\read.js:132:5\n    at AsyncResource.runInAsyncScope (node:async_hooks:214:14)\n    at invokeCallback (H:\\DACN\\backend\\node_modules\\raw-body\\index.js:238:16)\n    at done (H:\\DACN\\backend\\node_modules\\raw-body\\index.js:227:7)\n    at IncomingMessage.onEnd (H:\\DACN\\backend\\node_modules\\raw-body\\index.js:287:7)\n    at IncomingMessage.emit (node:events:519:28)\n    at endReadableNT (node:internal/streams/readable:1698:12)\n    at processTicksAndRejections (node:internal/process/task_queues:90:21)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:32 [error]: Refresh token verification error: Token verification failed {
        "service": "lms-backend",
        "stack": "Error: Token verification failed\n    at Object.verifyToken (H:\\DACN\\backend\\src\\utils\\jwt.util.ts:90:13)\n    at Object.verifyToken [as verifyRefreshToken] (H:\\DACN\\backend\\src\\utils\\token.util.ts:166:34)\n    at Object.verifyRefreshToken (H:\\DACN\\backend\\src\\utils\\jwt.util.ts:147:27)\n    at GlobalAuthService.verifyRefreshToken (H:\\DACN\\backend\\src\\services\\global\\auth.service.ts:31:29)\n    at AuthModuleService.verifyRefreshToken [as refreshToken] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:186:45)\n    at AuthController.refreshToken (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:117:45)\n    at refreshToken (H:\\DACN\\backend\\src\\modules\\auth\\auth.routes.ts:49:53)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:157:13)\n    at next (H:\\DACN\\backend\\src\\middlewares\\validate.middleware.ts:40:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:157:13)\n    at Route.dispatch (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:117:3)\n    at handle (H:\\DACN\\backend\\node_modules\\router\\index.js:435:11)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:295:15\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:688:15\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:276:14)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at urlencodedParser (H:\\DACN\\backend\\node_modules\\body-parser\\lib\\types\\urlencoded.js:57:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at H:\\DACN\\backend\\node_modules\\body-parser\\lib\\read.js:132:5\n    at AsyncResource.runInAsyncScope (node:async_hooks:214:14)\n    at invokeCallback (H:\\DACN\\backend\\node_modules\\raw-body\\index.js:238:16)\n    at done (H:\\DACN\\backend\\node_modules\\raw-body\\index.js:227:7)\n    at IncomingMessage.onEnd (H:\\DACN\\backend\\node_modules\\raw-body\\index.js:287:7)\n    at IncomingMessage.emit (node:events:519:28)\n    at endReadableNT (node:internal/streams/readable:1698:12)\n    at processTicksAndRejections (node:internal/process/task_queues:90:21)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:32 [error]: Error verifying refresh token: Invalid refresh token {
        "service": "lms-backend",
        "stack": "Error: Invalid refresh token\n    at Object.verifyRefreshToken (H:\\DACN\\backend\\src\\utils\\token.util.ts:181:15)\n    at Object.verifyRefreshToken (H:\\DACN\\backend\\src\\utils\\jwt.util.ts:147:27)\n    at GlobalAuthService.verifyRefreshToken (H:\\DACN\\backend\\src\\services\\global\\auth.service.ts:31:29)\n    at AuthModuleService.verifyRefreshToken [as refreshToken] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:186:45)\n    at AuthController.refreshToken (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:117:45)\n    at refreshToken (H:\\DACN\\backend\\src\\modules\\auth\\auth.routes.ts:49:53)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:157:13)\n    at next (H:\\DACN\\backend\\src\\middlewares\\validate.middleware.ts:40:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:157:13)\n    at Route.dispatch (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:117:3)\n    at handle (H:\\DACN\\backend\\node_modules\\router\\index.js:435:11)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:295:15\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:688:15\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:276:14)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at urlencodedParser (H:\\DACN\\backend\\node_modules\\body-parser\\lib\\types\\urlencoded.js:57:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at H:\\DACN\\backend\\node_modules\\body-parser\\lib\\read.js:132:5\n    at AsyncResource.runInAsyncScope (node:async_hooks:214:14)\n    at invokeCallback (H:\\DACN\\backend\\node_modules\\raw-body\\index.js:238:16)\n    at done (H:\\DACN\\backend\\node_modules\\raw-body\\index.js:227:7)\n    at IncomingMessage.onEnd (H:\\DACN\\backend\\node_modules\\raw-body\\index.js:287:7)\n    at IncomingMessage.emit (node:events:519:28)\n    at endReadableNT (node:internal/streams/readable:1698:12)\n    at processTicksAndRejections (node:internal/process/task_queues:90:21)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:32 [error]: Error refreshing token: invalid refresh token {
        "service": "lms-backend",
        "code": "AUTH_TOKEN_MISSING",
        "statusCode": 401,
        "type": "AUTHENTICATION",
        "severity": "MEDIUM",
        "isOperational": true,
        "details": {},
        "context": {},
        "stack": "Error: invalid refresh token\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.unauthorized (H:\\DACN\\backend\\src\\errors\\api.error.ts:86:12)\n    at AuthModuleService.unauthorized (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:189:24)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at AuthController.refreshToken (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:117:22)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:32 [error]: Error refreshing token: invalid refresh token {
        "service": "lms-backend",
        "code": "AUTH_TOKEN_MISSING",
        "statusCode": 401,
        "type": "AUTHENTICATION",
        "severity": "MEDIUM",
        "isOperational": true,
        "details": {},
        "context": {},
        "stack": "Error: invalid refresh token\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.unauthorized (H:\\DACN\\backend\\src\\errors\\api.error.ts:86:12)\n    at AuthModuleService.unauthorized (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:189:24)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at AuthController.refreshToken (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:117:22)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:32 [error]: HTTP error occurred {
        "service": "lms-backend",
        "error": "invalid refresh token",
        "stack": "Error: invalid refresh token\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.unauthorized (H:\\DACN\\backend\\src\\errors\\api.error.ts:86:12)\n    at AuthModuleService.unauthorized (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:189:24)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at AuthController.refreshToken (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:117:22)",
        "method": "POST",
        "url": "/api/auth/refresh",
        "statusCode": 401,
        "ip": "::ffff:127.0.0.1"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE email IN ($1, $2) OR username IN ($3, $4)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      2025-11-16 23:34:33 [error]: JWT verify token error: jwt malformed {
        "service": "lms-backend",
        "name": "JsonWebTokenError",
        "stack": "JsonWebTokenError: jwt malformed\n    at Object.module.exports [as verify] (H:\\DACN\\backend\\node_modules\\jsonwebtoken\\verify.js:70:17)\n    at Object.verify [as verifyToken] (H:\\DACN\\backend\\src\\utils\\jwt.util.ts:87:27)\n    at Object.verifyToken [as verifyRefreshToken] (H:\\DACN\\backend\\src\\utils\\token.util.ts:166:34)\n    at Object.verifyRefreshToken (H:\\DACN\\backend\\src\\utils\\jwt.util.ts:147:27)\n    at GlobalAuthService.verifyRefreshToken (H:\\DACN\\backend\\src\\services\\global\\auth.service.ts:31:29)\n    at AuthModuleService.verifyRefreshToken [as refreshToken] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:186:45)\n    at AuthController.refreshToken (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:117:45)\n    at refreshToken (H:\\DACN\\backend\\src\\modules\\auth\\auth.routes.ts:49:53)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:157:13)\n    at next (H:\\DACN\\backend\\src\\middlewares\\validate.middleware.ts:40:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:157:13)\n    at Route.dispatch (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:117:3)\n    at handle (H:\\DACN\\backend\\node_modules\\router\\index.js:435:11)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:295:15\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:688:15\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:276:14)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at urlencodedParser (H:\\DACN\\backend\\node_modules\\body-parser\\lib\\types\\urlencoded.js:57:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at H:\\DACN\\backend\\node_modules\\body-parser\\lib\\read.js:132:5\n    at AsyncResource.runInAsyncScope (node:async_hooks:214:14)\n    at invokeCallback (H:\\DACN\\backend\\node_modules\\raw-body\\index.js:238:16)\n    at done (H:\\DACN\\backend\\node_modules\\raw-body\\index.js:227:7)\n    at IncomingMessage.onEnd (H:\\DACN\\backend\\node_modules\\raw-body\\index.js:287:7)\n    at IncomingMessage.emit (node:events:519:28)\n    at endReadableNT (node:internal/streams/readable:1698:12)\n    at processTicksAndRejections (node:internal/process/task_queues:90:21)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:33 [error]: Refresh token verification error: Token verification failed {
        "service": "lms-backend",
        "stack": "Error: Token verification failed\n    at Object.verifyToken (H:\\DACN\\backend\\src\\utils\\jwt.util.ts:90:13)\n    at Object.verifyToken [as verifyRefreshToken] (H:\\DACN\\backend\\src\\utils\\token.util.ts:166:34)\n    at Object.verifyRefreshToken (H:\\DACN\\backend\\src\\utils\\jwt.util.ts:147:27)\n    at GlobalAuthService.verifyRefreshToken (H:\\DACN\\backend\\src\\services\\global\\auth.service.ts:31:29)\n    at AuthModuleService.verifyRefreshToken [as refreshToken] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:186:45)\n    at AuthController.refreshToken (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:117:45)\n    at refreshToken (H:\\DACN\\backend\\src\\modules\\auth\\auth.routes.ts:49:53)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:157:13)\n    at next (H:\\DACN\\backend\\src\\middlewares\\validate.middleware.ts:40:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:157:13)\n    at Route.dispatch (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:117:3)\n    at handle (H:\\DACN\\backend\\node_modules\\router\\index.js:435:11)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:295:15\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:688:15\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:276:14)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at urlencodedParser (H:\\DACN\\backend\\node_modules\\body-parser\\lib\\types\\urlencoded.js:57:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at H:\\DACN\\backend\\node_modules\\body-parser\\lib\\read.js:132:5\n    at AsyncResource.runInAsyncScope (node:async_hooks:214:14)\n    at invokeCallback (H:\\DACN\\backend\\node_modules\\raw-body\\index.js:238:16)\n    at done (H:\\DACN\\backend\\node_modules\\raw-body\\index.js:227:7)\n    at IncomingMessage.onEnd (H:\\DACN\\backend\\node_modules\\raw-body\\index.js:287:7)\n    at IncomingMessage.emit (node:events:519:28)\n    at endReadableNT (node:internal/streams/readable:1698:12)\n    at processTicksAndRejections (node:internal/process/task_queues:90:21)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:33 [error]: Error verifying refresh token: Invalid refresh token {
        "service": "lms-backend",
        "stack": "Error: Invalid refresh token\n    at Object.verifyRefreshToken (H:\\DACN\\backend\\src\\utils\\token.util.ts:181:15)\n    at Object.verifyRefreshToken (H:\\DACN\\backend\\src\\utils\\jwt.util.ts:147:27)\n    at GlobalAuthService.verifyRefreshToken (H:\\DACN\\backend\\src\\services\\global\\auth.service.ts:31:29)\n    at AuthModuleService.verifyRefreshToken [as refreshToken] (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:186:45)\n    at AuthController.refreshToken (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:117:45)\n    at refreshToken (H:\\DACN\\backend\\src\\modules\\auth\\auth.routes.ts:49:53)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:157:13)\n    at next (H:\\DACN\\backend\\src\\middlewares\\validate.middleware.ts:40:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:157:13)\n    at Route.dispatch (H:\\DACN\\backend\\node_modules\\router\\lib\\route.js:117:3)\n    at handle (H:\\DACN\\backend\\node_modules\\router\\index.js:435:11)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:295:15\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:688:15\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:276:14)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at urlencodedParser (H:\\DACN\\backend\\node_modules\\body-parser\\lib\\types\\urlencoded.js:57:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at H:\\DACN\\backend\\node_modules\\body-parser\\lib\\read.js:132:5\n    at AsyncResource.runInAsyncScope (node:async_hooks:214:14)\n    at invokeCallback (H:\\DACN\\backend\\node_modules\\raw-body\\index.js:238:16)\n    at done (H:\\DACN\\backend\\node_modules\\raw-body\\index.js:227:7)\n    at IncomingMessage.onEnd (H:\\DACN\\backend\\node_modules\\raw-body\\index.js:287:7)\n    at IncomingMessage.emit (node:events:519:28)\n    at endReadableNT (node:internal/streams/readable:1698:12)\n    at processTicksAndRejections (node:internal/process/task_queues:90:21)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:33 [error]: Error refreshing token: invalid refresh token {
        "service": "lms-backend",
        "code": "AUTH_TOKEN_MISSING",
        "statusCode": 401,
        "type": "AUTHENTICATION",
        "severity": "MEDIUM",
        "isOperational": true,
        "details": {},
        "context": {},
        "stack": "Error: invalid refresh token\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.unauthorized (H:\\DACN\\backend\\src\\errors\\api.error.ts:86:12)\n    at AuthModuleService.unauthorized (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:189:24)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at AuthController.refreshToken (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:117:22)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:33 [error]: Error refreshing token: invalid refresh token {
        "service": "lms-backend",
        "code": "AUTH_TOKEN_MISSING",
        "statusCode": 401,
        "type": "AUTHENTICATION",
        "severity": "MEDIUM",
        "isOperational": true,
        "details": {},
        "context": {},
        "stack": "Error: invalid refresh token\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.unauthorized (H:\\DACN\\backend\\src\\errors\\api.error.ts:86:12)\n    at AuthModuleService.unauthorized (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:189:24)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at AuthController.refreshToken (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:117:22)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:33 [error]: HTTP error occurred {
        "service": "lms-backend",
        "error": "invalid refresh token",
        "stack": "Error: invalid refresh token\n    at new ApiError (H:\\DACN\\backend\\src\\errors\\api.error.ts:48:5)\n    at Function.unauthorized (H:\\DACN\\backend\\src\\errors\\api.error.ts:86:12)\n    at AuthModuleService.unauthorized (H:\\DACN\\backend\\src\\modules\\auth\\auth.service.ts:189:24)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at AuthController.refreshToken (H:\\DACN\\backend\\src\\modules\\auth\\auth.controller.ts:117:22)",
        "method": "POST",
        "url": "/api/auth/refresh",
        "statusCode": 401,
        "ip": "::ffff:127.0.0.1"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE email IN ($1, $2) OR username IN ($3, $4)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE email IN ($1, $2) OR username IN ($3, $4)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
             VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE email IN ($1, $2) OR username IN ($3, $4)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      2025-11-16 23:34:35 [error]: JWT verify token error: jwt malformed {
        "service": "lms-backend",
        "name": "JsonWebTokenError",
        "stack": "JsonWebTokenError: jwt malformed\n    at Object.module.exports [as verify] (H:\\DACN\\backend\\node_modules\\jsonwebtoken\\verify.js:70:17)\n    at Object.verify [as verifyToken] (H:\\DACN\\backend\\src\\utils\\jwt.util.ts:87:27)\n    at Object.verifyToken [as verifyAccessToken] (H:\\DACN\\backend\\src\\utils\\token.util.ts:112:34)\n    at verifyAccessToken (H:\\DACN\\backend\\src\\middlewares\\auth.middleware.ts:35:38)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:688:15\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:276:14)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at urlencodedParser (H:\\DACN\\backend\\node_modules\\body-parser\\lib\\types\\urlencoded.js:77:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at jsonParser (H:\\DACN\\backend\\node_modules\\body-parser\\lib\\types\\json.js:109:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at cors (H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:188:7)\n    at H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:224:17\n    at callback (H:\\DACN\\backend\\src\\config\\cors.config.ts:8:7)\n    at H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:219:13\n    at optionsCallback (H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:199:9)\n    at corsMiddleware (H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:204:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:531:6)\n    at xXssProtectionMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:311:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xPoweredByMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:304:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xPermittedCrossDomainPoliciesMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:297:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xFrameOptionsMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:281:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xDownloadOptionsMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:261:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xDnsPrefetchControlMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:254:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xContentTypeOptionsMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:246:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at strictTransportSecurityMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:239:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at referrerPolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:207:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at originAgentClusterMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:182:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at crossOriginResourcePolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:175:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at crossOriginOpenerPolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:159:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at contentSecurityPolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:124:4)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at helmetMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:533:6)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:35 [error]: Access token verification error: Token verification failed {
        "service": "lms-backend",
        "stack": "Error: Token verification failed\n    at Object.verifyToken (H:\\DACN\\backend\\src\\utils\\jwt.util.ts:90:13)\n    at Object.verifyToken [as verifyAccessToken] (H:\\DACN\\backend\\src\\utils\\token.util.ts:112:34)\n    at verifyAccessToken (H:\\DACN\\backend\\src\\middlewares\\auth.middleware.ts:35:38)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:688:15\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:276:14)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at urlencodedParser (H:\\DACN\\backend\\node_modules\\body-parser\\lib\\types\\urlencoded.js:77:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at jsonParser (H:\\DACN\\backend\\node_modules\\body-parser\\lib\\types\\json.js:109:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at cors (H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:188:7)\n    at H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:224:17\n    at callback (H:\\DACN\\backend\\src\\config\\cors.config.ts:8:7)\n    at H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:219:13\n    at optionsCallback (H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:199:9)\n    at corsMiddleware (H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:204:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:531:6)\n    at xXssProtectionMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:311:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xPoweredByMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:304:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xPermittedCrossDomainPoliciesMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:297:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xFrameOptionsMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:281:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xDownloadOptionsMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:261:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xDnsPrefetchControlMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:254:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xContentTypeOptionsMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:246:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at strictTransportSecurityMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:239:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at referrerPolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:207:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at originAgentClusterMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:182:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at crossOriginResourcePolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:175:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at crossOriginOpenerPolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:159:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at contentSecurityPolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:124:4)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at helmetMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:533:6)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      2025-11-16 23:34:35 [error]: Token verification failed: Invalid access token {
        "service": "lms-backend",
        "stack": "Error: Invalid access token\n    at Object.verifyAccessToken (H:\\DACN\\backend\\src\\utils\\token.util.ts:128:15)\n    at verifyAccessToken (H:\\DACN\\backend\\src\\middlewares\\auth.middleware.ts:35:38)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:688:15\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:276:14)\n    at Function.handle (H:\\DACN\\backend\\node_modules\\router\\index.js:186:3)\n    at router (H:\\DACN\\backend\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at urlencodedParser (H:\\DACN\\backend\\node_modules\\body-parser\\lib\\types\\urlencoded.js:77:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at jsonParser (H:\\DACN\\backend\\node_modules\\body-parser\\lib\\types\\json.js:109:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at cors (H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:188:7)\n    at H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:224:17\n    at callback (H:\\DACN\\backend\\src\\config\\cors.config.ts:8:7)\n    at H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:219:13\n    at optionsCallback (H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:199:9)\n    at corsMiddleware (H:\\DACN\\backend\\node_modules\\cors\\lib\\index.js:204:7)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:531:6)\n    at xXssProtectionMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:311:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xPoweredByMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:304:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xPermittedCrossDomainPoliciesMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:297:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xFrameOptionsMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:281:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xDownloadOptionsMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:261:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xDnsPrefetchControlMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:254:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at xContentTypeOptionsMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:246:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at strictTransportSecurityMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:239:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at referrerPolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:207:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at originAgentClusterMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:182:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at crossOriginResourcePolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:175:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at crossOriginOpenerPolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:159:3)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at contentSecurityPolicyMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:124:4)\n    at internalNext (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:529:6)\n    at helmetMiddleware (H:\\DACN\\backend\\node_modules\\helmet\\index.cjs:533:6)\n    at Layer.handleRequest (H:\\DACN\\backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (H:\\DACN\\backend\\node_modules\\router\\index.js:342:13)\n    at H:\\DACN\\backend\\node_modules\\router\\index.js:297:9\n    at processParams (H:\\DACN\\backend\\node_modules\\router\\index.js:582:12)\n    at next (H:\\DACN\\backend\\node_modules\\router\\index.js:291:5)"
      } traceId=00000000000000000000000000000000 spanId=0000000000000000

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

PASS src/tests/integration/database/database.integration.test.ts (9.343 s)
  ΓùÅ Console

    console.log
      [dotenv@17.2.3] injecting env (25) from src\tests\integration\test.env -- tip: ΓÜÖ∩╕Å  suppress all logs with { quiet: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

    console.log
      Γ£à Model associations setup completed

      at log (src/models/associations.ts:263:11)

    console.log
      Γ£à Extended model associations setup completed

      at log (src/models/associations-extended.ts:340:11)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)
               RETURNING *

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind SELECT * FROM users WHERE email = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind SELECT * FROM users WHERE username = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind UPDATE users SET first_name = $1, last_name = $2, bio = $3, updated_at = $4 WHERE id = $5 RETURNING *

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM users WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind SELECT * FROM users WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
                 VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.error
      [SQL_SHIM_ERROR] default Validation error INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
                 VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      126 |         .catch((err: any) => {
      127 |         // eslint-disable-next-line no-console
    > 128 |         console.error('[SQL_SHIM_ERROR] default', err?.message, typeof sqlText === 'string' ? sqlText : '<<non-string-sql>>');
          |                 ^
      129 |         throw err;
      130 |       });
      131 |     };

      at src/tests/utils/test.utils.ts:128:17
      at Object.<anonymous> (src/tests/integration/database/database.integration.test.ts:232:7)

    console.error
      [SQL_SHIM_ERROR] replacements->bind Validation error INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
                 VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      221 |             if (process.env.JEST_WORKER_ID) {
      222 |               // eslint-disable-next-line no-console
    > 223 |               console.error('[SQL_SHIM_ERROR] replacements->bind', err?.message, replacedSql);
          |                       ^
      224 |             }
      225 |             throw err;
      226 |           });

      at src/tests/utils/test.utils.ts:223:23
      at Object.<anonymous> (src/tests/integration/database/database.integration.test.ts:232:7)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
                 VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.error
      [SQL_SHIM_ERROR] default Validation error INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
                 VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      126 |         .catch((err: any) => {
      127 |         // eslint-disable-next-line no-console
    > 128 |         console.error('[SQL_SHIM_ERROR] default', err?.message, typeof sqlText === 'string' ? sqlText : '<<non-string-sql>>');
          |                 ^
      129 |         throw err;
      130 |       });
      131 |     };

      at src/tests/utils/test.utils.ts:128:17
      at Object.<anonymous> (src/tests/integration/database/database.integration.test.ts:266:7)

    console.error
      [SQL_SHIM_ERROR] replacements->bind Validation error INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
                 VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      221 |             if (process.env.JEST_WORKER_ID) {
      222 |               // eslint-disable-next-line no-console
    > 223 |               console.error('[SQL_SHIM_ERROR] replacements->bind', err?.message, replacedSql);
          |                       ^
      224 |             }
      225 |             throw err;
      226 |           });

      at src/tests/utils/test.utils.ts:223:23
      at Object.<anonymous> (src/tests/integration/database/database.integration.test.ts:266:7)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO courses (id, title, description, instructor_id, status, price, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8)
               RETURNING *

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO courses (id, title, description, instructor_id, status, price, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO courses (id, title, description, instructor_id, status, price, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO courses (id, title, description, instructor_id, status, price, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind SELECT * FROM courses WHERE instructor_id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
                 VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
                 VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
                 VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO courses (id, title, description, instructor_id, level, status, price, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO courses (id, title, description, instructor_id, level, status, price, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO courses (id, title, description, instructor_id, level, status, price, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind SELECT * FROM courses WHERE level = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO courses (id, title, description, instructor_id, status, price, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind UPDATE courses SET title = $1, description = $2, price = $3, updated_at = $4 WHERE id = $5 RETURNING *

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO users (id, email, username, password, first_name, last_name, role, status, email_verified, two_factor_enabled, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind INSERT INTO courses (id, title, description, instructor_id, status, price, created_at, updated_at)
               VALUES ($1, $2, $3, $4, $5, $6, $7, $8)

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind DELETE FROM courses WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

    console.log
      [SQL_SHIM] replacements->bind SELECT * FROM courses WHERE id = $1

      at Sequelize.db.query (src/tests/utils/test.utils.ts:216:21)

PASS src/tests/integration/modules/quiz/quiz.service.integration.test.ts
  ΓùÅ Console

    console.log
      [dotenv@17.2.3] injecting env (25) from src\tests\integration\test.env -- tip: ΓÜÖ∩╕Å  enable debug logging with { debug: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

    console.log
      Γ£à Model associations setup completed

      at log (src/models/associations.ts:263:11)

    console.log
      Γ£à Extended model associations setup completed

      at log (src/models/associations-extended.ts:340:11)

PASS src/tests/integration/api/routes.debug.test.ts
  ΓùÅ Console

    console.log
      [dotenv@17.2.3] injecting env (25) from src\tests\integration\test.env -- tip: ≡ƒöä add secrets lifecycle management: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

    console.log
      Γ£à Model associations setup completed

      at log (src/models/associations.ts:263:11)

    console.log
      Γ£à Extended model associations setup completed

      at log (src/models/associations-extended.ts:340:11)

    console.log
      [API_ROUTE_DEBUG_COUNT] 4

      at Object.<anonymous> (src/app.ts:150:11)

    console.log
      [API_ROUTE_DEBUG_LIST] [
        'GET /users/profile',
        'PUT /users/profile',
        'PUT /users/change-password',
        'GET /__routes_debug'
      ]

      at Object.<anonymous> (src/app.ts:152:11)

    console.log
      OpenTelemetry tracing started (local only, no OTLP export)

      at log (src/tracing/tracing.ts:45:15)

    console.log
      ROUTES_DEBUG: {
        routes: [
          'GET /users/profile',
          'PUT /users/profile',
          'PUT /users/change-password',
          'GET /__routes_debug'
        ]
      }

      at Object.<anonymous> (src/tests/integration/api/routes.debug.test.ts:17:13)

-----------------------------------|---------|----------|---------|---------|----------------------------------------------------------------------------------------------------------------------------------------------------------
File                               | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s                                                                                                                                        
-----------------------------------|---------|----------|---------|---------|----------------------------------------------------------------------------------------------------------------------------------------------------------
All files                          |   23.44 |    11.86 |   15.02 |   23.57 |                                                                                                                                                          
 api                               |    80.7 |    43.75 |   85.71 |   79.24 |                                                                                                                                                          
  index.ts                         |     100 |      100 |     100 |     100 |                                                                                                                                                          
  routes.ts                        |   78.84 |    43.75 |   83.33 |   77.55 | 45,52,73-87                                                                                                                                              
 api/v1                            |     100 |      100 |     100 |     100 |                                                                                                                                                          
  index.ts                         |     100 |      100 |     100 |     100 |                                                                                                                                                          
 api/v1/routes                     |    94.8 |      100 |       0 |     100 |                                                                                                                                                          
  assignment.routes.ts             |     100 |      100 |     100 |     100 |                                                                                                                                                          
  auth.routes.ts                   |     100 |      100 |     100 |     100 |                                                                                                                                                          
  course.routes.ts                 |     100 |      100 |     100 |     100 |                                                                                                                                                          
  enrollment.routes.ts             |     100 |      100 |     100 |     100 |                                                                                                                                                          
  index.ts                         |   94.11 |      100 |       0 |     100 |                                                                                                                                                          
  lesson.routes.ts                 |     100 |      100 |     100 |     100 |                                                                                                                                                          
  quiz.routes.ts                   |     100 |      100 |     100 |     100 |                                                                                                                                                          
  section.routes.ts                |     100 |      100 |     100 |     100 |                                                                                                                                                          
  user.routes.ts                   |   88.88 |      100 |       0 |     100 |                                                                                                                                                          
 api/v2                            |     100 |      100 |     100 |     100 |                                                                                                                                                          
  index.ts                         |     100 |      100 |     100 |     100 |                                                                                                                                                          
 api/v2/routes                     |      84 |      100 |       0 |      84 |                                                                                                                                                          
  auth.routes.ts                   |   77.77 |      100 |       0 |   77.77 | 16,27                                                                                                                                                    
  index.ts                         |     100 |      100 |     100 |     100 |                                                                                                                                                          
  user.routes.ts                   |   77.77 |      100 |       0 |   77.77 | 16,27                                                                                                                                                    
 api/versioning                    |   27.56 |     6.75 |   18.75 |   25.87 |                                                                                                                                                          
  index.ts                         |     100 |      100 |   33.33 |     100 |                                                                                                                                                          
  version.config.ts                |     100 |      100 |     100 |     100 |                                                                                                                                                          
  version.manager.ts               |   11.71 |     4.16 |      12 |   12.39 | 42,46,52,74-205,212-249,261-287,295-323,335-393                                                                                                          
  version.routes.ts                |     100 |      100 |     100 |     100 |                                                                                                                                                          
 cache                             |    2.92 |     0.57 |       0 |    2.33 |                                                                                                                                                          
  cache-configuration.manager.ts   |       0 |        0 |       0 |       0 | 6-546                                                                                                                                                    
  cache-invalidation.manager.ts    |       0 |        0 |       0 |       0 | 6-560                                                                                                                                                    
  cache-performance.analyzer.ts    |       0 |        0 |       0 |       0 | 6-343                                                                                                                                                    
  cache.manager.ts                 |    2.73 |        0 |       0 |    2.79 | 27-475                                                                                                                                                   
  cache.middleware.ts              |    5.66 |      2.4 |       0 |    5.84 | 25-357,368-371,375                                                                                                                                       
  cache.routes.ts                  |       0 |      100 |       0 |       0 | 6-492                                                                                                                                                    
  enhanced-cache.middleware.ts     |       0 |        0 |       0 |       0 | 8-431                                                                                                                                                    
  index.ts                         |     100 |      100 |       0 |     100 |                                                                                                                                                          
 cache/strategies                  |    1.78 |        0 |       0 |    1.84 |                                                                                                                                                          
  hybrid.strategy.ts               |    2.56 |        0 |       0 |    2.68 | 26-423                                                                                                                                                   
  memory.strategy.ts               |    1.03 |        0 |       0 |    1.05 | 17-496                                                                                                                                                   
  redis.strategy.ts                |    1.94 |        0 |       0 |    2.01 | 11-397                                                                                                                                                   
 config                            |    36.8 |    39.23 |   33.33 |   35.76 |                                                                                                                                                          
  cors.config.ts                   |      80 |       50 |      50 |    87.5 | 10                                                                                                                                                       
  db.ts                            |   36.58 |    26.53 |      25 |   35.89 | 20-25,52-73,80-103                                                                                                                                       
  env.config.ts                    |    92.3 |    56.86 |     100 |     100 | 6,12-55,59-90                                                                                                                                            
  index.ts                         |       0 |      100 |     100 |       0 | 2-5                                                                                                                                                      
  jwt.config.ts                    |     100 |       50 |       0 |     100 | 3-7                                                                                                                                                      
  mail.config.ts                   |       0 |        0 |       0 |       0 | 1-106                                                                                                                                                    
  redis.config.ts                  |    28.2 |    33.33 |       0 |    28.2 | 13,20,24,28,33-38,45-81                                                                                                                                  
  swagger.config.ts                |     100 |      100 |     100 |     100 |                                                                                                                                                          
 constants                         |   95.16 |    89.28 |     100 |   95.16 |                                                                                                                                                          
  app.constants.ts                 |     100 |       50 |     100 |     100 | 66-73                                                                                                                                                    
  response.constants.ts            |     100 |      100 |     100 |     100 |                                                                                                                                                          
  roles.enum.ts                    |     100 |      100 |     100 |     100 |                                                                                                                                                          
  user.constants.ts                |       0 |      100 |     100 |       0 | 2-65                                                                                                                                                     
 errors                            |   29.92 |    22.22 |   18.18 |   33.86 |                                                                                                                                                          
  api.error.ts                     |   62.06 |    57.89 |   36.36 |      72 | 114-198                                                                                                                                                  
  authentication.error.ts          |    5.71 |        0 |       0 |    7.14 | 42-203                                                                                                                                                   
  authorization.error.ts           |   58.33 |    56.52 |    12.5 |      75 | 87-188                                                                                                                                                   
  base.error.ts                    |   73.33 |    53.33 |   54.54 |   73.33 | 75,108,137-146,161-162                                                                                                                                   
  database.error.ts                |   55.73 |    39.21 |      30 |   67.34 | 79-181,210-211,217-250,274-289                                                                                                                           
  error.constants.ts               |       0 |      100 |     100 |       0 | 7-151                                                                                                                                                    
  error.factory.ts                 |    17.5 |        6 |   16.66 |    17.5 | 26-134,157-286,306                                                                                                                                       
  error.handler.ts                 |   55.88 |    35.13 |      30 |   55.88 | 51,65-94,128-137,152,154,156,158-159,161,163-164,175-221                                                                                                 
  error.utils.ts                   |   19.73 |    18.18 |   27.77 |      20 | 14-67,78,104,110-122,150-160,175-275                                                                                                                     
  external-service.error.ts        |       4 |        0 |       0 |    4.87 | 47-238                                                                                                                                                   
  file.error.ts                    |    5.55 |        0 |       0 |    7.14 | 45-211                                                                                                                                                   
  index.ts                         |       0 |      100 |       0 |       0 | 7-29                                                                                                                                                     
  validation.error.ts              |    5.71 |        0 |       0 |    6.89 | 46-185                                                                                                                                                   
 middlewares                       |   56.48 |    41.96 |      50 |   55.65 |                                                                                                                                                          
  auth-rate-limit.middleware.ts    |   66.66 |    30.76 |   33.33 |   63.63 | 7,26-28                                                                                                                                                  
  auth.middleware.ts               |    65.3 |    61.11 |      75 |   63.04 | 50-51,66-67,71-77,97-115                                                                                                                                 
  error.middleware.ts              |   55.55 |        0 |       0 |   55.55 | 20-24                                                                                                                                                    
  logger.middleware.ts             |     100 |    71.42 |     100 |     100 | 11-24                                                                                                                                                    
  tracing.middleware.ts            |   71.05 |       50 |   42.85 |   71.05 | 50-53,61-67,71-72,77-78                                                                                                                                  
  uuid-validation.middleware.ts    |       0 |        0 |       0 |       0 | 3-66                                                                                                                                                     
  validate-dto.middleware.ts       |       0 |        0 |       0 |       0 | 2-118                                                                                                                                                    
  validate.middleware.ts           |   81.81 |    56.52 |   84.61 |   81.25 | 37,69,103,117-126                                                                                                                                        
 models                            |   69.02 |     1.42 |   18.98 |   68.52 |                                                                                                                                                          
  assignment-submission.model.ts   |     100 |      100 |     100 |     100 |                                                                                                                                                          
  assignment.model.ts              |     100 |      100 |     100 |     100 |                                                                                                                                                          
  associations-extended.ts         |     100 |      100 |     100 |     100 |                                                                                                                                                          
  associations.ts                  |     100 |      100 |     100 |     100 |                                                                                                                                                          
  category.model.ts                |   47.05 |        0 |       0 |   47.05 | 108,115-163                                                                                                                                              
  chat-message.model.ts            |    87.5 |      100 |       0 |    87.5 | 85                                                                                                                                                       
  course-statistics.model.ts       |     100 |      100 |     100 |     100 |                                                                                                                                                          
  course.model.ts                  |   55.55 |        0 |       0 |   55.55 | 67-129                                                                                                                                                   
  enrollment.model.ts              |     100 |      100 |     100 |     100 |                                                                                                                                                          
  final-grade.model.ts             |     100 |      100 |     100 |     100 |                                                                                                                                                          
  grade-component.model.ts         |     100 |      100 |     100 |     100 |                                                                                                                                                          
  grade.model.ts                   |     100 |      100 |     100 |     100 |                                                                                                                                                          
  index.ts                         |    98.5 |       50 |      52 |   97.67 | 54                                                                                                                                                       
  lesson-material.model.ts         |      40 |        0 |       0 |    42.1 | 109-117,124-142                                                                                                                                          
  lesson-progress.model.ts         |   20.51 |        0 |       0 |   21.62 | 128-158,165-219                                                                                                                                          
  lesson.model.ts                  |   25.92 |        0 |       0 |   25.92 | 121-134,140-170                                                                                                                                          
  live-session-attendance.model.ts |     100 |      100 |     100 |     100 |                                                                                                                                                          
  live-session.model.ts            |     100 |      100 |     100 |     100 |                                                                                                                                                          
  notification-recipient.model.ts  |   16.12 |        0 |       0 |   17.54 | 118-156,179-288                                                                                                                                          
  notification.model.ts            |   38.09 |        0 |       0 |   38.09 | 145-161,168-212                                                                                                                                          
  password-reset-token.model.ts    |   61.53 |        0 |       0 |   61.53 | 86-90,97-109                                                                                                                                             
  quiz-answer.model.ts             |     100 |      100 |     100 |     100 |                                                                                                                                                          
  quiz-attempt.model.ts            |     100 |      100 |     100 |     100 |                                                                                                                                                          
  quiz-option.model.ts             |     100 |      100 |     100 |     100 |                                                                                                                                                          
  quiz-question.model.ts           |     100 |      100 |     100 |     100 |                                                                                                                                                          
  quiz.model.ts                    |     100 |      100 |     100 |     100 |                                                                                                                                                          
  section.model.ts                 |      28 |        0 |       0 |      28 | 86-99,106-133                                                                                                                                            
  user-activity-log.model.ts       |     100 |      100 |     100 |     100 |                                                                                                                                                          
  user.model.ts                    |     100 |      100 |     100 |     100 |                                                                                                                                                          
 modules/analytics                 |      48 |        0 |   15.38 |   53.33 |                                                                                                                                                          
  analytics.controller.ts          |   35.29 |        0 |   33.33 |   35.29 | 13-18,23-29                                                                                                                                              
  analytics.repository.ts          |      50 |        0 |       0 |      50 | 5-9                                                                                                                                                      
  analytics.routes.ts              |     100 |      100 |     100 |     100 |                                                                                                                                                          
  analytics.service.ts             |      60 |        0 |   33.33 |      60 | 11-15                                                                                                                                                    
  analytics.validate.ts            |     100 |      100 |     100 |     100 |                                                                                                                                                          
  index.ts                         |       0 |      100 |       0 |       0 | 2-7                                                                                                                                                      
 modules/assignment                |   35.21 |       20 |   35.29 |   34.54 |                                                                                                                                                          
  assignment.controller.ts         |   14.28 |        0 |      10 |   14.28 | 16-22,27-33,38-44,49-165                                                                                                                                 
  assignment.repository.ts         |   43.75 |       20 |   53.33 |   45.16 | 37-52,84-88,153-223                                                                                                                                      
  assignment.routes.ts             |     100 |      100 |     100 |     100 |                                                                                                                                                          
  assignment.service.ts            |   32.02 |     22.5 |    42.1 |   32.66 | 21-36,61-130,142,147,152-153,176-224,236,245,250-251,259-286,299,316                                                                                     
  assignment.validate.ts           |      50 |        0 |       0 |      50 | 6-7                                                                                                                                                      
  index.ts                         |     100 |      100 |      20 |     100 |                                                                                                                                                          
 modules/auth                      |   39.06 |    25.35 |   28.73 |   38.72 |                                                                                                                                                          
  auth.controller.ts               |   41.66 |    29.16 |      50 |   41.66 | 45-109,131-132,138-139,148-149,164-187                                                                                                                   
  auth.repository.ts               |   24.72 |     11.9 |   36.36 |   24.72 | 22-23,44-45,72-113,132-153,166,176-177,195-213,229,234-469                                                                                               
  auth.routes.ts                   |   76.47 |      100 |   33.33 |   76.47 | 35,42,55,72,79,87,94,101                                                                                                                                 
  auth.service.ts                  |    51.7 |     37.5 |   54.54 |    51.7 | 45,51,83-84,104,123,197-199,206-208,230,250,256,286-445                                                                                                  
  auth.validate.ts                 |       0 |        0 |       0 |       0 | 1-450                                                                                                                                                    
  index.ts                         |     100 |      100 |   33.33 |     100 |                                                                                                                                                          
 modules/category                  |   36.45 |        0 |   13.04 |   39.77 |                                                                                                                                                          
  category.controller.ts           |   27.02 |        0 |   16.66 |   27.77 | 13-19,24-30,35-39,44-49,54-59                                                                                                                            
  category.repository.ts           |      25 |        0 |      20 |   27.77 | 14-43                                                                                                                                                    
  category.routes.ts               |     100 |      100 |     100 |     100 |                                                                                                                                                          
  category.service.ts              |   33.33 |        0 |   14.28 |   33.33 | 14-49                                                                                                                                                    
  category.validate.ts             |     100 |      100 |     100 |     100 |                                                                                                                                                          
  index.ts                         |       0 |      100 |       0 |       0 | 1-6                                                                                                                                                      
 modules/chat                      |       0 |        0 |       0 |       0 |                                                                                                                                                          
  chat.controller.ts               |       0 |        0 |       0 |       0 | 7-179                                                                                                                                                    
  chat.gateway.ts                  |       0 |        0 |       0 |       0 | 7-488                                                                                                                                                    
  chat.repository.ts               |       0 |        0 |       0 |       0 | 6-385                                                                                                                                                    
  chat.routes.ts                   |       0 |      100 |     100 |       0 | 6-65                                                                                                                                                     
  chat.service.ts                  |       0 |        0 |       0 |       0 | 6-176                                                                                                                                                    
  chat.types.ts                    |       0 |        0 |       0 |       0 | 152-192                                                                                                                                                  
  index.ts                         |       0 |      100 |       0 |       0 | 6-11                                                                                                                                                     
 modules/course                    |   13.33 |        0 |    4.54 |   13.68 |                                                                                                                                                          
  course.controller.ts             |   16.83 |        0 |    9.09 |   16.83 | 20-30,36-62,68-78,84-99,105-120,126-146,152-175,181-197,203-218,224-240                                                                                  
  course.repository.ts             |    6.25 |        0 |    4.16 |    6.42 | 21-353                                                                                                                                                   
  course.routes.ts                 |     100 |      100 |     100 |     100 |                                                                                                                                                          
  course.service.ts                |     5.4 |        0 |    9.09 |     5.4 | 22-259                                                                                                                                                   
  course.validate.ts               |       0 |        0 |       0 |       0 | 1-231                                                                                                                                                    
  index.ts                         |       0 |      100 |       0 |       0 | 7-53                                                                                                                                                     
 modules/course-content            |   13.69 |        0 |    3.44 |    14.1 |                                                                                                                                                          
  course-content.controller.ts     |   15.78 |        0 |    4.76 |   15.78 | 26-40,49-66,75-86,95-108,117-129,138-151,164-178,187-199,208-221,230-242,251-264,277-291,300-312,321-332,345-358,367-379,388-400,409-421,430-442,455-472 
  course-content.repository.ts     |     3.3 |        0 |    3.03 |    3.57 | 51-432                                                                                                                                                   
  course-content.routes.ts         |     100 |      100 |     100 |     100 |                                                                                                                                                          
  course-content.service.ts        |    3.61 |        0 |    3.57 |    3.61 | 32-476                                                                                                                                                   
  course-content.validate.ts       |     100 |      100 |     100 |     100 |                                                                                                                                                          
  index.ts                         |       0 |      100 |       0 |       0 | 2-7                                                                                                                                                      
 modules/enrollment                |   10.58 |        0 |     3.7 |   10.98 |                                                                                                                                                          
  enrollment.controller.ts         |    4.23 |        0 |    5.88 |    4.23 | 20-299                                                                                                                                                   
  enrollment.repository.ts         |    5.22 |        0 |       4 |    5.78 | 20-367                                                                                                                                                   
  enrollment.routes.ts             |    62.5 |      100 |       0 |    62.5 | 21,28,35,44,52,60,69,78,87,94,102,110,119,127,134                                                                                                        
  enrollment.service.ts            |    4.92 |        0 |    5.26 |    5.03 | 7-8,30-351                                                                                                                                               
  enrollment.validate.ts           |      30 |        0 |       0 |      30 | 28-130                                                                                                                                                   
 modules/files                     |       0 |        0 |       0 |       0 |                                                                                                                                                          
  files.controller.ts              |       0 |        0 |       0 |       0 | 8-259                                                                                                                                                    
  files.routes.ts                  |       0 |      100 |     100 |       0 | 6-80                                                                                                                                                     
  files.service.ts                 |       0 |        0 |       0 |       0 | 6-452                                                                                                                                                    
  files.types.ts                   |       0 |        0 |       0 |       0 | 78-183                                                                                                                                                   
  index.ts                         |       0 |      100 |       0 |       0 | 6-10                                                                                                                                                     
  upload.middleware.ts             |       0 |        0 |       0 |       0 | 6-230                                                                                                                                                    
 modules/grade                     |   14.41 |        0 |    5.88 |   15.16 |                                                                                                                                                          
  grade.controller.ts              |   31.81 |      100 |      25 |   31.81 | 13-18,23-28,33-38                                                                                                                                        
  grade.repository.ts              |    9.75 |        0 |    4.16 |      10 | 23-110                                                                                                                                                   
  grade.routes.ts                  |     100 |      100 |     100 |     100 |                                                                                                                                                          
  grade.service.ts                 |    4.51 |        0 |    5.55 |    4.68 | 20-293                                                                                                                                                   
  grade.validate.ts                |     100 |      100 |     100 |     100 |                                                                                                                                                          
  index.ts                         |       0 |      100 |       0 |       0 | 2-7                                                                                                                                                      
 modules/lesson                    |   25.56 |        0 |   13.63 |   26.15 |                                                                                                                                                          
  lesson.controller.ts             |   15.38 |        0 |   16.66 |   15.38 | 18-121                                                                                                                                                   
  lesson.repository.ts             |      25 |        0 |   33.33 |   29.41 | 13-53                                                                                                                                                    
  lesson.routes.ts                 |      75 |      100 |       0 |      75 | 20,27,35,44,52                                                                                                                                           
  lesson.service.ts                |      12 |        0 |   16.66 |      12 | 23-115                                                                                                                                                   
  lesson.validate.ts               |      50 |        0 |       0 |      50 | 6-7                                                                                                                                                      
 modules/livestream                |   38.66 |        0 |   10.52 |   42.02 |                                                                                                                                                          
  index.ts                         |       0 |      100 |       0 |       0 | 2-7                                                                                                                                                      
  livestream.controller.ts         |   27.58 |      100 |      20 |   27.58 | 13-18,23-28,33-38,43-49                                                                                                                                  
  livestream.repository.ts         |      20 |        0 |       0 |   22.22 | 11-38                                                                                                                                                    
  livestream.routes.ts             |     100 |      100 |     100 |     100 |                                                                                                                                                          
  livestream.service.ts            |   33.33 |        0 |      20 |   33.33 | 14-37                                                                                                                                                    
  livestream.validate.ts           |     100 |      100 |     100 |     100 |                                                                                                                                                          
 modules/notifications             |    31.4 |        0 |   11.53 |   34.86 |                                                                                                                                                          
  index.ts                         |       0 |      100 |       0 |       0 | 2-7                                                                                                                                                      
  notifications.controller.ts      |   24.32 |        0 |   16.66 |   24.32 | 14-19,24-49,54-59,64-69,74-80                                                                                                                            
  notifications.repository.ts      |   21.42 |        0 |   11.11 |   25.71 | 21-130                                                                                                                                                   
  notifications.routes.ts          |     100 |      100 |     100 |     100 |                                                                                                                                                          
  notifications.service.ts         |   21.42 |        0 |   16.66 |   21.42 | 13-44                                                                                                                                                    
  notifications.validate.ts        |     100 |      100 |     100 |     100 |                                                                                                                                                          
 modules/quiz                      |   28.26 |    17.08 |   28.28 |   28.66 |                                                                                                                                                          
  index.ts                         |     100 |      100 |      20 |     100 |                                                                                                                                                          
  quiz.controller.ts               |       5 |        0 |    6.66 |       5 | 18-356                                                                                                                                                   
  quiz.repository.ts               |   28.39 |     12.5 |   55.55 |   33.84 | 61-79,109-130,162-168,216-226,271-279,305-372                                                                                                            
  quiz.routes.ts                   |   63.15 |      100 |       0 |   63.15 | 20,27,35,44,52,61,68,77,86,94,103,111,118,125                                                                                                            
  quiz.service.ts                  |   30.67 |    24.24 |   31.42 |   31.55 | 21-34,52-137,149,158-215,223,233-260,272,277,282,286,292,298,307-308,316,320,324,330,336,359-360,370-433,446,470-484,493-498                             
  quiz.validate.ts                 |      40 |        0 |       0 |      40 | 6-34                                                                                                                                                     
 modules/section                   |   25.95 |        0 |   13.63 |   26.35 |                                                                                                                                                          
  section.controller.ts            |   15.38 |        0 |   16.66 |   15.38 | 18-120                                                                                                                                                   
  section.repository.ts            |   27.77 |        0 |   33.33 |   31.25 | 13-51                                                                                                                                                    
  section.routes.ts                |      75 |      100 |       0 |      75 | 20,27,35,44,52                                                                                                                                           
  section.service.ts               |      12 |        0 |   16.66 |      12 | 22-114                                                                                                                                                   
  section.validate.ts              |      50 |        0 |       0 |      50 | 6-7                                                                                                                                                      
 modules/system-settings           |       0 |        0 |       0 |       0 |                                                                                                                                                          
  system.settings.controller.ts    |       0 |        0 |       0 |       0 | 2-41                                                                                                                                                     
  system.settings.routes.ts        |       0 |      100 |       0 |       0 | 1-15                                                                                                                                                     
  system.settings.service.ts       |       0 |        0 |       0 |       0 | 1-54                                                                                                                                                     
 modules/user                      |   30.31 |    29.23 |   27.52 |    29.8 |                                                                                                                                                          
  index.ts                         |     100 |      100 |      60 |     100 |                                                                                                                                                          
  user.admin.controller.ts         |   66.66 |    58.33 |     100 |   66.66 | 43-46,60-61,74,84,89-94,110,115,121-128,141,146,152,202-203,217-218,231-232,245,251,256,262-268                                                          
  user.admin.routes.ts             |   93.75 |      100 |   81.81 |   93.75 | 106,131                                                                                                                                                  
  user.controller.ts               |   19.79 |    16.66 |   28.57 |   19.79 | 23,41-46,61-207                                                                                                                                          
  user.repository.ts               |    2.68 |        0 |    5.26 |    2.68 | 57-485                                                                                                                                                   
  user.routes.ts                   |    57.4 |        0 |       0 |    57.4 | 24-27,43-47,57-61,68,75,81,87,95,101,106,113,119,126,133,146                                                                                             
  user.service.ts                  |   16.04 |     4.54 |   15.78 |   16.14 | 33,41-42,56,70-428                                                                                                                                       
  user.validate.ts                 |       0 |        0 |       0 |       0 | 1-369                                                                                                                                                    
 modules/webrtc                    |       0 |        0 |       0 |       0 |                                                                                                                                                          
  index.ts                         |       0 |      100 |     100 |       0 | 6-8                                                                                                                                                      
  webrtc.gateway.ts                |       0 |        0 |       0 |       0 | 7-574                                                                                                                                                    
  webrtc.service.ts                |       0 |        0 |       0 |       0 | 6-152                                                                                                                                                    
  webrtc.types.ts                  |       0 |        0 |       0 |       0 | 27-166                                                                                                                                                   
 monitoring                        |   94.73 |      100 |      40 |      90 |                                                                                                                                                          
  index.ts                         |     100 |      100 |   44.44 |     100 |                                                                                                                                                          
  ping.routes.ts                   |      80 |      100 |       0 |      80 | 28                                                                                                                                                       
 monitoring/health                 |   22.35 |        0 |   11.11 |   20.95 |                                                                                                                                                          
  health.controller.ts             |   23.07 |        0 |   11.11 |   23.07 | 23-28,37-42,51-60,69-78,87-96,105-114,123-128,137-142                                                                                                    
  health.routes.ts                 |     100 |      100 |     100 |     100 |                                                                                                                                                          
  health.service.ts                |    7.07 |        0 |    6.66 |    7.07 | 131-432                                                                                                                                                  
  index.ts                         |     100 |      100 |   33.33 |     100 |                                                                                                                                                          
 monitoring/metrics                |   27.55 |    29.27 |   19.28 |   28.04 |                                                                                                                                                          
  background-tasks.metrics.ts      |       0 |        0 |       0 |       0 | 7-318                                                                                                                                                    
  database.metrics.ts              |       0 |        0 |       0 |       0 | 8-235                                                                                                                                                    
  index.ts                         |     100 |      100 |      40 |     100 |                                                                                                                                                          
  metrics.controller.ts            |   10.21 |        0 |     3.7 |   10.38 | 36-40,49-53,62-78,87-103,112-131,140-159,168-178,187-191,200-209,218-227,236-245,254-265,274-382                                                         
  metrics.middleware.ts            |   71.57 |    70.49 |   43.47 |      80 | 88,96,190,205,212,226,233,246-255                                                                                                                        
  metrics.routes.ts                |     100 |       50 |     100 |     100 | 14-324                                                                                                                                                   
  metrics.service.ts               |   49.32 |    45.56 |      40 |    50.7 | 103,161,185,217,238-397,411,438-441,459-470,478,488-515                                                                                                  
  redis.metrics.ts                 |       0 |        0 |       0 |       0 | 8-292                                                                                                                                                    
 repositories                      |   31.82 |    38.23 |   39.34 |   29.44 |                                                                                                                                                          
  base.repository.ts               |   52.02 |    56.25 |   61.11 |   52.02 | 76-77,99-100,117-118,135-136,156,161,167-168,188,208-353,392-393                                                                                         
  enrollment.repository.ts         |       0 |        0 |       0 |       0 | 2-245                                                                                                                                                    
  index.ts                         |       0 |      100 |       0 |       0 | 7-40                                                                                                                                                     
  user.repository.ts               |   32.46 |    28.57 |      50 |   24.63 | 39-88,107-238,296-416                                                                                                                                    
 routes                            |       0 |      100 |     100 |       0 |                                                                                                                                                          
  user.routes.ts                   |       0 |      100 |     100 |       0 | 9-12                                                                                                                                                     
 services/global                   |   28.95 |    18.13 |    32.8 |   28.47 |                                                                                                                                                          
  account-lockout.service.ts       |   51.16 |       40 |      80 |      50 | 21-30,47-51,62-63,74-94                                                                                                                                  
  auth.service.ts                  |   43.75 |      100 |   57.14 |   43.75 | 13-24,45-46,55-78                                                                                                                                        
  cache.service.ts                 |   31.03 |    23.52 |   56.25 |   29.26 | 24-28,36-42,50-86,96-97,107-108,118-141,151-163,174-184                                                                                                  
  email.service.ts                 |    6.06 |        0 |   16.66 |    6.06 | 23-140                                                                                                                                                   
  file.service.ts                  |    5.71 |        0 |      20 |    5.71 | 42-136                                                                                                                                                   
  index.ts                         |   96.87 |      100 |       0 |     100 |                                                                                                                                                          
  password-security.service.ts     |   35.55 |    33.33 |   42.85 |   36.36 | 16,20,53-54,67-95,113-130                                                                                                                                
  session-management.service.ts    |   39.17 |    30.76 |      40 |   40.86 | 53-79,92-94,100-140,155,164,172-173,177,185-197,216-231                                                                                                  
  two-factor.service.ts            |    6.77 |        0 |    9.09 |     7.2 | 17-225                                                                                                                                                   
  user-refactored.service.ts       |       0 |        0 |       0 |       0 | 1-369                                                                                                                                                    
  user.service.ts                  |      50 |    43.47 |   66.66 |   51.18 | 84,96-97,107,114-115,120-159,176,191-243,256-261,266,270-273,289-290,298,337-338,347-348,357-358,371-372                                                 
 services/media                    |       0 |        0 |       0 |       0 |                                                                                                                                                          
  cloudinary.service.ts            |       0 |        0 |       0 |       0 | 1-41                                                                                                                                                     
 services/storage                  |       0 |        0 |       0 |       0 |                                                                                                                                                          
  gcs.service.ts                   |       0 |        0 |       0 |       0 | 1-103                                                                                                                                                    
  storage.factory.ts               |       0 |        0 |       0 |       0 | 1-16                                                                                                                                                     
 shared                            |       0 |      100 |     100 |       0 |                                                                                                                                                          
  index.ts                         |       0 |      100 |     100 |       0 | 4-6                                                                                                                                                      
 shared/base                       |       0 |        0 |       0 |       0 |                                                                                                                                                          
  base.controller.ts               |       0 |        0 |       0 |       0 | 6-191                                                                                                                                                    
 swagger/paths                     |     100 |      100 |     100 |     100 |                                                                                                                                                          
  assignment.paths.ts              |     100 |      100 |     100 |     100 |                                                                                                                                                          
  auth.paths.ts                    |     100 |      100 |     100 |     100 |                                                                                                                                                          
  chat.paths.ts                    |     100 |      100 |     100 |     100 |                                                                                                                                                          
  course.paths.ts                  |     100 |      100 |     100 |     100 |                                                                                                                                                          
  enrollment.paths.ts              |     100 |      100 |     100 |     100 |                                                                                                                                                          
  grade.paths.ts                   |     100 |      100 |     100 |     100 |                                                                                                                                                          
  lesson.paths.ts                  |     100 |      100 |     100 |     100 |                                                                                                                                                          
  live-session.paths.ts            |     100 |      100 |     100 |     100 |                                                                                                                                                          
  notification.paths.ts            |     100 |      100 |     100 |     100 |                                                                                                                                                          
  quiz.paths.ts                    |     100 |      100 |     100 |     100 |                                                                                                                                                          
  section.paths.ts                 |     100 |      100 |     100 |     100 |                                                                                                                                                          
  user.paths.ts                    |     100 |      100 |     100 |     100 |                                                                                                                                                          
 swagger/schemas                   |     100 |      100 |     100 |     100 |                                                                                                                                                          
  assignment.schema.ts             |     100 |      100 |     100 |     100 |                                                                                                                                                          
  auth.schema.ts                   |     100 |      100 |     100 |     100 |                                                                                                                                                          
  chat.schema.ts                   |     100 |      100 |     100 |     100 |                                                                                                                                                          
  course.schema.ts                 |     100 |      100 |     100 |     100 |                                                                                                                                                          
  enrollment.schema.ts             |     100 |      100 |     100 |     100 |                                                                                                                                                          
  grade.schema.ts                  |     100 |      100 |     100 |     100 |                                                                                                                                                          
  lesson.schema.ts                 |     100 |      100 |     100 |     100 |                                                                                                                                                          
  live-session.schema.ts           |     100 |      100 |     100 |     100 |                                                                                                                                                          
  notification.schema.ts           |     100 |      100 |     100 |     100 |                                                                                                                                                          
  quiz.schema.ts                   |     100 |      100 |     100 |     100 |                                                                                                                                                          
  section.schema.ts                |     100 |      100 |     100 |     100 |                                                                                                                                                          
  user.schema.ts                   |     100 |      100 |     100 |     100 |                                                                                                                                                          
 tracing                           |   75.86 |       50 |      50 |   75.86 |                                                                                                                                                          
  tracing.ts                       |   75.86 |       50 |      50 |   75.86 | 28,43,48,54-58                                                                                                                                           
 types                             |       0 |        0 |       0 |       0 |                                                                                                                                                          
  index.ts                         |       0 |      100 |       0 |       0 | 14-78                                                                                                                                                    
  type-utilities.ts                |       0 |        0 |       0 |       0 | 18-581                                                                                                                                                   
  user.types.ts                    |       0 |        0 |       0 |       0 | 139-151                                                                                                                                                  
 types/dtos                        |       0 |        0 |       0 |       0 |                                                                                                                                                          
  enrollment.dto.ts                |       0 |        0 |       0 |       0 | 1-59                                                                                                                                                     
  index.ts                         |       0 |      100 |     100 |       0 | 6-21                                                                                                                                                     
 utils                             |   18.85 |     7.22 |   11.71 |   19.55 |                                                                                                                                                          
  bcrypt.util.ts                   |   19.04 |       10 |   28.57 |   19.04 | 20-22,36-130                                                                                                                                             
  constants.util.ts                |     100 |      100 |     100 |     100 |                                                                                                                                                          
  date.util.ts                     |    7.43 |     1.92 |    5.71 |    7.43 | 25-34,57-311                                                                                                                                             
  file.util.ts                     |    6.12 |        0 |       0 |    6.25 | 29-286                                                                                                                                                   
  hash.util.ts                     |   33.84 |        0 |    6.89 |   33.84 | 26-27,42-325                                                                                                                                             
  index.ts                         |     100 |      100 |      25 |     100 |                                                                                                                                                          
  jwt.util.ts                      |      40 |        0 |      25 |      40 | 72-73,100-105,128-138,157-223,243-270                                                                                                                    
  logger.util.ts                   |   35.89 |     18.6 |   26.66 |   37.83 | 126-137,145,150,154,158,181-265                                                                                                                          
  model-extension.util.ts          |   45.16 |    10.71 |   23.52 |   45.16 | 17-20,41,56,125-128,139-146,161,171,185-186,196-197,208,218-219,233-240,255,264-267                                                                      
  object.util.ts                   |    5.58 |     8.47 |    5.55 |    6.38 | 11-63,73-121,130,133,146-375                                                                                                                             
  pagination.util.ts               |    1.85 |        0 |       0 |    1.88 | 46-235                                                                                                                                                   
  response.util.ts                 |   67.34 |    36.53 |   42.85 |   66.66 | 79-103,145-165,175,179,191,207-249                                                                                                                       
  role.util.ts                     |    3.44 |        0 |       0 |    3.84 | 15-178                                                                                                                                                   
  secure.util.ts                   |    5.76 |        0 |       0 |       6 | 16-149                                                                                                                                                   
  token.util.ts                    |   23.93 |     6.06 |   22.72 |   24.56 | 100-101,118,154-155,172,192-365,381-504                                                                                                                  
  type.util.ts                     |       0 |        0 |       0 |       0 | 7-319                                                                                                                                                    
  user.util.ts                     |   10.38 |        0 |   10.52 |   10.66 | 123-150,168-382                                                                                                                                          
  validators.util.ts               |    5.88 |     5.12 |    6.66 |    8.21 | 21-34,55-109,130-353                                                                                                                                     
 utils/string                      |   12.47 |     0.32 |    0.64 |   14.82 |                                                                                                                                                          
  crypto.util.ts                   |   13.63 |     4.76 |     2.7 |    12.3 | 15-179,206-382                                                                                                                                           
  extract.util.ts                  |    1.51 |        0 |       0 |    1.98 | 14-354                                                                                                                                                   
  format.util.ts                   |    2.56 |        0 |       0 |    2.85 | 14-245                                                                                                                                                   
  index.ts                         |     100 |      100 |     100 |     100 |                                                                                                                                                          
  mask.util.ts                     |    0.95 |        0 |       0 |     1.2 | 13-275                                                                                                                                                   
  normalize.util.ts                |    0.82 |        0 |       0 |    1.09 | 23-398                                                                                                                                                   
 utils/tests                       |       0 |      100 |     100 |       0 |                                                                                                                                                          
  index.ts                         |       0 |      100 |     100 |       0 | 7-15                                                                                                                                                     
 validates                         |   22.22 |        0 |    10.2 |   23.63 |                                                                                                                                                          
  auth.validate.ts                 |   20.68 |        0 |   14.28 |   20.68 | 50,82-139                                                                                                                                                
  base.validate.ts                 |   35.71 |        0 |   23.52 |   35.71 | 74-81,181-256                                                                                                                                            
  course.validate.ts               |   41.66 |        0 |       0 |   41.66 | 98-121                                                                                                                                                   
  file.validate.ts                 |       0 |        0 |       0 |       0 | 1-88                                                                                                                                                     
  index.ts                         |       0 |      100 |       0 |       0 | 7-53                                                                                                                                                     
  user.validate.ts                 |   35.71 |        0 |       0 |   35.71 | 99-114,215-238                                                                                                                                           
-----------------------------------|---------|----------|---------|---------|----------------------------------------------------------------------------------------------------------------------------------------------------------
Jest: "global" coverage threshold for statements (25%) not met: 23.44%
Jest: "global" coverage threshold for branches (15%) not met: 11.86%
Jest: "global" coverage threshold for lines (25%) not met: 23.57%
Jest: "global" coverage threshold for functions (18%) not met: 15.02%

Test Suites: 2 failed, 5 passed, 7 total
Tests:       7 failed, 86 passed, 93 total
Snapshots:   0 total
Time:        79.447 s
Ran all test suites matching src/tests/integration/modules/assignment/assignment.service.integration.test.ts|integration.
